{% extends "spareapp/contBase.html" %}

{% block title %} To Collect {% endblock %}

{% block content %}

<div class="container d-flex justify-content-center container mt-5 col-lg-4">
    <label for=""><span style="font-weight: bold;color: rgb(136,12,12);">Por cobrar</span></label>
</div>

<div class="container mt-2">
    <table style="font-size: small;" class="table-bordered invoice">
        <thead>
            <tr class="color text-white">
                <th class="p-2"># Factura</th>
                <th class="p-2">Nombre</th>
                <th class="p-2">Categoría</th>
                <th class="p-2">Fecha de registro</th>
                <th class="p-2">Límite</th>
                <th class="p-2">Sub total</th>
                <th class="p-2">IVA</th>
                <th class="p-2">Total</th>
                <th class="p-2">Acción</th>
            </tr>
        </thead>

        <tbody>
            {% for facture in allFacturesPay %}
            <tr>
                <td class="p-2">{{facture.num}}</td>
                <td class="p-2"><a href="{% url 'contIndividual' facture.refPersona.id %}">{{facture.refPersona}}</a></td>
                <td class="p-2">{{facture.refCategory}}</td>
                <td class="p-2">{{facture.fechaCreado|date:"M d, Y"}}</td>
                {% for key,value in deadlineDic.items %}
                    {% if key == facture.id %}
                        <td style="max-width: 120px;" class="p-2">{{value}} days</td>
                    {% endif %}
                {% endfor %}
                <td class="p-2">${{facture.monto|floatformat:2}}</td>
                <td class="p-2">{{facture.iva|floatformat:2}}</td>
                <td class="p-2">${{facture.total|floatformat:2}}</td>
                <td class="p-2"><a data-bs-toggle="modal" type="button" data-bs-target="#modalCobrar{{facture.id}}" style="font-size: small;color: aliceblue;" id="modalCobrar{{facture.id}}Id" class="btn btn-danger" href="javascript:void(0);">Cobrar</a></td>

                <div tabindex="-1" id="modalCobrar{{facture.id}}" class="modal fade modal-dialog-scrollable" aria-labelledby="modalCobrar{{facture.id}}Label" aria-hidden="true">
                    <div class="modal-dialog">
                        <div class="modal-content">
                            <div class="modal-header">
                                <h5 class="modal-title" id="modalCobrar{{facture.id}}Label">Tipo de pago</h5>
                                <button type="button" class="btn-close" data-bs-dismiss="modal" aria-label="Close"></button>
                            </div>
                            <div class="modal-body"> 
                                <form id="formCust" method="POST" action="{% url 'contCollectFac' facture.id %}">
                                    {% csrf_token %}
                                    <select name="contTypeIng" id="contTypeIng" class="form-select form-select-md mb-3" required>
                                        <option value="" selected>Seleccione tipo de pago</option>
                                        {% for type in allTypes %}
                                        <option value="{{type.id}}">{{type.nombre}}</option>
                                        {% endfor %}
                                    </select>
                                    <button type="button" class="btn btn-secondary" data-bs-dismiss="modal">Close</button>
                                    <button type="submit" class="btn btn-primary">Save</button>
                                </form>
                                
                            </div>   
                        </div>
                    </div>
                </div> 

            </tr>
            
            {% endfor %}
            
            <tr>
                <td class="p-2 color text-white">Total</td>
                <td class="p-2"></td>
                <td class="p-2"></td>
                <td class="p-2"></td>
                <td class="p-2"></td>
                <td class="p-2">${{montoTotal|floatformat:2}}</td>
                <td class="p-2"></td>
                <td class="p-2">${{totalTotal|floatformat:2}}</td>
                <td class="p-2"></td>
            </tr>
            
        </tbody>
    </table>
</div>




{% endblock %}