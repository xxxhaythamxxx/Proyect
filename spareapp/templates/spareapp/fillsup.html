<html>
    <div class="container d-flex justify-content-center mt-4">
        <div>
            <a style="font-size: small;" href="{% url 'listAdmin' %}" class="btn color text-white">List users</a>
            <a style="font-size: small;" href="{% url 'listcar' %}" class="btn color text-white">List cars</a>
            <a style="font-size: small;" href="{% url 'listengine' %}" class="btn color text-white">List engines</a>
            <a style="font-size: small;" href="{% url 'listspare' %}" class="btn color text-white">List spares</a>
            <a style="font-size: small;" href="{% url 'listcat' %}" class="btn color text-white">List categories</a>
            <a style="font-size: small;" href="{% url 'listmake' %}" class="btn color text-white">List make</a>
            <a style="font-size: small;" href="{% url 'listbrand' %}" class="btn color text-white">List brand</a>
            <a style="font-size: small;" href="{% url 'updateAll' %}" class="btn color text-white">Update</a>
            <!-- <a style="font-size: small;" href="{% url 'listList' %}" class="btn color text-white">List example</a> -->
            
        </div>
    </div>
    <div class="container d-flex justify-content-center mt-1">
        <div>
            <a style="font-size: small;" href="{% url 'fillcar' %}" class="btn btn-success">Register car</a>
            <a style="font-size: small;" href="{% url 'fillengine' %}" class="btn btn-success">Register engine</a>
            <a style="font-size: small;" href="{% url 'fillspare' %}" class="btn btn-success">Register spare</a>
            <a style="font-size: small;" href="{% url 'fillcategoryadmin' %}" class="btn btn-success">Register category</a>
            <a style="font-size: small;" href="{% url 'fillbrand' %}" class="btn btn-success">Register brand</a>
            <!-- <a style="font-size: small;" href="{% url 'fillsubcategory' %}" class="btn btn-success">Register sub category</a> -->
            
        </div>
    </div>
    <!-- <div class="container d-flex justify-content-center mt-1">
        <div>
            <a href="{% url 'listcar' %}" class="btn btn-secondary">Edit Car</a>
            <a href="{% url 'listengine' %}" class="btn btn-secondary">Edit engine</a>
            <a href="{% url 'listspare' %}" class="btn btn-secondary">Edit spare</a>
        </div>
    </div> -->
    <div class="container d-flex justify-content-center mt-1">
        <div>
            <!-- <a class="btn btn-danger" href="{% url 'importCar' %}">Import car</a> -->
            <a style="font-size: small;" data-bs-toggle="modal" data-bs-target="#carImportModal" id="carImportModalButton" class="btn btn-danger" href="javascript:void(0);">Import car</a>
            <!-- <a style="font-size: small;" data-bs-toggle="modal" data-bs-target="#engineImportModal" id="engineImportModalButton" class="btn btn-danger" href="javascript:void(0);">Import engine</a> -->
            <a style="font-size: small;" data-bs-toggle="modal" data-bs-target="#spareImportModal" id="spareImportModalButton" class="btn btn-danger" href="javascript:void(0);">Import spare</a>
            <a style="font-size: small;" data-bs-toggle="modal" data-bs-target="#categoryImportModal" id="categoryImportModalButton" class="btn btn-danger" href="javascript:void(0);">Import categories</a>
            <a style="font-size: small;" id="exportCategoriesButton" href="#" class="btn btn-danger">Export categories</a>
            <!-- <a class="btn btn-danger" href="{% url 'importEngine' %}">Import engine</a> -->
            <!-- <a class="btn btn-danger" href="{% url 'importSpare' %}">Import spare</a> -->
        </div>
    </div>

    <div tabindex="-1" id="carImportModal" class="modal fade modal-dialog-scrollable" aria-labelledby="carInputLabel" aria-hidden="true">
        <div class="modal-dialog">
            <div class="modal-content">
                <div class="modal-header">
                    <h5 class="modal-title" id="carInputLabel">Import car from Excel</h5>
                    <button type="button" class="btn-close" data-bs-dismiss="modal" aria-label="Close"></button>
                </div>
                <div class="modal-body">
                    <!-- Aqui el modal -->
                    <div class="container mt-3 col-lg-12">
                        <form action="{% url 'importCar' %}" method="POST" enctype="multipart/form-data">
                            {% csrf_token %}
                            <label for="phot" class="form-label">Parameters:</label>
                            <div>MAKE</div>
                            <div>MODEL</div>
                            <div>YEAR</div>
                            <div class="mb-3">CHASIS</div>
                            <input title=" " value="" type="file" class="form-control" name="phot" id="phot" aria-describedby="photoHelp">
                        </div>
                        <div class="mt-4">
                            <button type="button" class="btn btn-secondary" data-bs-dismiss="modal">Close</button>
                            <button id="carInputSubmit" type="submit" class="btn btn-primary">Save</button>
                        </div>
                    </form>
                </div>
            </div>
        </div>
    </div>

    <div tabindex="-1" id="engineImportModal" class="modal fade modal-dialog-scrollable" aria-labelledby="engineInputLabel" aria-hidden="true">
        <div class="modal-dialog">
            <div class="modal-content">
                <div class="modal-header">
                    <h5 class="modal-title" id="engineInputLabel">Import engine from Excel</h5>
                    <button type="button" class="btn-close" data-bs-dismiss="modal" aria-label="Close"></button>
                </div>
                <div class="modal-body">
                    <!-- Aqui el modal -->
                    <div class="container mt-3 col-lg-12">
                        <form action="{% url 'importEngine' %}" method="POST" enctype="multipart/form-data">
                            {% csrf_token %}
                            <label for="phot" class="form-label">Parameters:</label>
                            <div>litres</div>
                            <div>ecode</div>
                            <div>type</div>
                            <div>valve</div>
                            <div class="mb-3">pistons</div>
                            <input title=" " value="" type="file" class="form-control" name="phot" id="phot" aria-describedby="photoHelp">
                        </div>
                        <div class="mt-4">
                            <button type="button" class="btn btn-secondary" data-bs-dismiss="modal">Close</button>
                            <button id="engineInputSubmit" type="submit" class="btn btn-primary">Save</button>
                        </div>
                    </form>
                </div>
            </div>
        </div>
    </div>

    <div tabindex="-1" id="spareImportModal" class="modal fade modal-dialog-scrollable" aria-labelledby="spareInputLabel" aria-hidden="true">
        <div class="modal-dialog">
            <div class="modal-content">
                <div class="modal-header">
                    <h5 class="modal-title" id="spareInputLabel">Import spare from Excel</h5>
                    <button type="button" class="btn-close" data-bs-dismiss="modal" aria-label="Close"></button>
                </div>
                <div class="modal-body">
                    <!-- Aqui el modal -->
                    <div class="container mt-3 col-lg-12">
                        <form action="{% url 'importSpare' %}" method="POST" enctype="multipart/form-data">
                            {% csrf_token %}
                            <label for="phot" class="form-label">Parameters:</label>
                            <div>code</div>
                            <div>description</div>
                            <div>pricem</div>
                            <div>priced</div>
                            <div>reference</div>
                            <div>attribute</div>
                            <div>dimension</div>
                            <div>category</div>
                            <div>vendor</div>
                            <div class="mb-3">note</div>
                            <input title=" " value="" type="file" class="form-control" name="phot" id="phot" aria-describedby="photoHelp">
                        </div>
                        <div class="mt-4">
                            <button type="button" class="btn btn-secondary" data-bs-dismiss="modal">Close</button>
                            <button id="spareInputSubmit" type="submit" class="btn btn-primary">Save</button>
                        </div>
                    </form>
                </div>
            </div>
        </div>
    </div>

    <div tabindex="-1" id="categoryImportModal" class="modal fade modal-dialog-scrollable" aria-labelledby="categoryInputLabel" aria-hidden="true">
        <div class="modal-dialog">
            <div class="modal-content">
                <div class="modal-header">
                    <h5 class="modal-title" id="categoryInputLabel">Import categories from Excel</h5>
                    <button type="button" class="btn-close" data-bs-dismiss="modal" aria-label="Close"></button>
                </div>
                <div class="modal-body">
                    <!-- Aqui el modal -->
                    <div class="container mt-3 col-lg-12">
                        <form action="{% url 'importCategory' %}" method="POST" enctype="multipart/form-data">
                            {% csrf_token %}
                            <label for="phot" class="form-label">Parameters:</label>
                            <div>category</div>
                            <input title=" " value="" type="file" class="form-control" name="phot" id="phot" aria-describedby="photoHelp">
                        </div>
                        <div class="mt-4">
                            <button type="button" class="btn btn-secondary" data-bs-dismiss="modal">Close</button>
                            <button id="spareInputSubmit" type="submit" class="btn btn-primary">Save</button>
                        </div>
                    </form>
                </div>
            </div>
        </div>
    </div>
    <table id="exportCategories"></table>
</html>

<script>
// boton para exportar a Excel -------------------------------------------------------------------------------------
document.getElementById("exportCategoriesButton").addEventListener("click",function(){

    var val = "exportCategories"

    $.ajax({
        method: 'GET',
        url: '/exportCategories',
        data: {'val': val},
        success:function(data){
            
            // Obtén una referencia a la tabla
            var tabla = $('#exportCategories');
        
            // Crea una fila de encabezado
            var encabezado = $('<tr></tr>');
            encabezado.append('<th>CATEGORY</th>');
            encabezado.append('<th>ATRIBUTES</th>');
            tabla.append(encabezado);
        
            // Crea filas de datos
            for(var i = 0; i < data.allCategories.length; i++){
                var fila1 = $('<tr></tr>');
                fila1.append('<td>'+data.allCategories[i].category+'</td>');
                var col2 = $('<td></td>');
                for(var j = 0; j < data.allAtributes.length; j++){
                    if(data.allCategories[i].id == data.allAtributes[j].atributeSpare__spare_category__id){
                        var div = $('<div></div>')
                        div.append(''+data.allAtributes[j].atributeName+'\n')
                        col2.append(div)
                    }
                }
                fila1.append(col2)
                tabla.append(fila1)
            }
            $("#exportCategories td").css("white-space", "pre-wrap");
            console.log(tabla)
            var table2excel = new Table2Excel();
            table2excel.export(document.querySelectorAll("#exportCategories"));
            tabla.remove()
        }
    })
})
</script>

