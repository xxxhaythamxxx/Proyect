{% extends "spareapp/fillbase.html" %}

{% block title %} List {% endblock %}

{% block content %}

{% include "spareapp/fillsup.html" %}

<div class="container invoicecont mt-5 mb-5">
    <div class="row d-flex justify-content-center">
        <div class="col-lg-5">
            <input type="text" class="form-control" name="cod" id="cod" aria-describedby="codHelp" placeholder="Search by code, description, category or vendor">
        </div>
    </div>

    <div class="col-12">

        <div class="col-12">
            <div class="row mt-2">
                <div class="col-2 color text-white p-2" class="col">Code</div>
                <div class="col-2 color text-white p-2" class="col">Brand</div>
                <div class="col-2 color text-white p-2" class="col">Description</div>
                <div class="col-2 color text-white p-2" class="col">Category</div>
                <div class="col-2 color text-white p-2" class="col">Ref. Codes</div>
                <div class="col-2 color text-white p-2" class="col">Quantity</div>
            </div>
        </div>

        {% for br in allSparesall %}

        <div class="col-12 accordion accordion-flush" id="accordionFlushExample">
            <div class="row mt-2 accordion-item">
                <div class="accordion-header color" id="flush-heading{{br.id}}">
                    <div class="p-2 collapsed color text-white" type="button" data-bs-toggle="collapse" data-bs-target="#flush-collapse{{br.id}}" aria-expanded="false" aria-controls="flush-collapse{{br.id}}">
                        <div class="row">
                            <div class="col-2">{{br.spare_code}}</div>
                            <div class="col-2">{{br.spare_brand}}</div>
                            <div class="col-2"></div>
                            <div class="col-2"></div>
                            <div class="col-2"></div>
                            {% for key,value in cantidad.items %}
                            {% if key == br.id %}
                            <div class="col-2">{{value.0}}</div>
                            {% endif %}
                            {% endfor %}
                        </div>
                        
                    </div>
                </div>
                
                <div id="flush-collapse{{br.id}}" class="accordion-collapse collapse" aria-labelledby="flush-heading{{br.id}}" data-bs-parent="#accordionFlushExample">
                {% for c in allReferences %}
                {% if c.referenceSpare == br %}
                    <div class="accordion-body">
                        
                        <div class="col-12">
                        
                            <div class="row mt-2">
                                <div class="col-2"><a style="text-decoration: none;" href="#">{{br.spare_code}}</a></div>
                                <div class="col-2"><a style="text-decoration: none;" href="#">{{br.spare_brand}}</a></div>
                                <div class="col-2"><a style="text-decoration: none;" href="#">{{br.spare_name}}</a></div>
                                <div class="col-2"><a style="text-decoration: none;" href="#">{{br.spare_category}}</a></div>
                                <div class="col-2"><a style="text-decoration: none;" href="#">{{c.referenceCode}}</a></div>
                                <div class="col-2"><a style="text-decoration: none;" href="#">{{c.cantidad}}</a></div>
                            </div>
                        
                        </div>
                        
                    </div>
                {% endif %}
                {% endfor %}
                </div>
                
            </div>
        </div>

        {% endfor %}

    </div>
</div>

<script>

$("#cod").on("keyup",function(){                                // Cuando se teclea algo
    var value = $(this).val().toLowerCase();                        // Toma el valor del input en minuscula
    $(".accordion-item").filter(function(){                             // 
        $(this).toggle($(this).text().toLowerCase().indexOf(value) > -1)
    })
})
</script>
{% endblock %}