{% extends "spareapp/contBase.html" %}

{% block title %} Day {% endblock %}

{% block content %}

{% load static %}

{% include "spareapp/contSuperior.html" %}

{% include "spareapp/accountStatSuperior.html" %}

<input id="dateTo" value="{{dateTo}}" type="text" hidden>
<input id="dateFrom" value="{{dateFrom}}" type="text" hidden>
<input id="requestP" value="{{request.path}}" type="text" hidden>
{% if busqueda %}
    <input id="busquedaValor" value="{{busqueda}}" type="text" hidden>
{% endif %}

<div class="collapse show" id="collapseExample2">

<div class="container mt-2 col-lg-4">

<form action="" method="POST">
    {% csrf_token %}
    <div class="mb-3">
        <label class="form-label" for="contNombre">Cliente</label>
        <select name="contNombre" id="contNombre" class="form-select form-select-md" aria-label=".form-select-md example" required>
            <option value="" selected>Seleccionar cliente</option>
            {% for cust in allCustomers %}
            <option value="{{cust.id}}" {% if cust.id|slugify == auxNombre|slugify %} selected {% else %} '' {% endif %}>{{cust.nombre}} - {{cust.documento}}</option>
            {% endfor %}
        </select>
    </div>
    <div class="mb-3">
        <input value="all" class="form-check-input" id="search1" type="radio" name="search" {% if searchMetodo == 'all' %} checked {$ else %} '' {% endif %}>
        <label class="form-check-label" for="search1">Todos</label>
        <input value="month" class="form-check-input" id="search2" type="radio" name="search" {% if searchMetodo == 'month' %} checked {$ else %} '' {% endif %}>
        <label class="form-check-label" for="search2">Éste mes</label>
        <input value="range" class="form-check-input" id="search4" type="radio" name="search" {% if searchMetodo == 'range' %} checked {$ else %} '' {% endif %}>
        <label class="form-check-label" for="search4">Rango</label>
        <input value="balance" class="form-check-input" id="search5" type="radio" name="search" {% if searchMetodo == 'balance' %} checked {$ else %} '' {% endif %}>
        <label class="form-check-label" for="search5">Último balance</label>
    </div>
    <div class="mb-3" id="formByRange2" style="display: none;">
        <div class="col-lg-12">
            <div class="row">
                <div class="col-lg-6">
                    <label for="searchDateFrom">Desde</label>
                    <input name="searchDateFrom" id="searchDateFrom" class="form-control" type="date">
                </div>
                <div class="col-lg-6">
                    <label for="searchDateTo">Hasta</label>
                    <input name="searchDateTo" id="searchDateTo" class="form-control" type="date">
                </div>
            </div>
        </div>
    </div>
    <button style="font-size: small;" class="btn btn-primary" type="submit">Aceptar</button>
    <a style="font-size: small;" href="{% url 'contDay' %}" class="btn btn-danger">Cancelar</a>
</form>

</div>

<!-- Fin del collapse -->
</div>

{% if factureName %}

<div class="mx-2 my-2">
    <svg type="button" data-bs-toggle="collapse" data-bs-target="#collapseExample2" aria-expanded="false" aria-controls="collapseExample2" xmlns="http://www.w3.org/2000/svg" width="20" height="20" fill="currentColor" class="bi bi-arrow-down-left-square-fill" viewBox="0 0 16 16">
        <path d="M2 16a2 2 0 0 1-2-2V2a2 2 0 0 1 2-2h12a2 2 0 0 1 2 2v12a2 2 0 0 1-2 2H2zm8.096-10.803L6 9.293V6.525a.5.5 0 0 0-1 0V10.5a.5.5 0 0 0 .5.5h3.975a.5.5 0 0 0 0-1H6.707l4.096-4.096a.5.5 0 1 0-.707-.707z"/>
    </svg>
</div>

<div class="container mt-2">

<div class="collapse show" id="collapseExample2">

{% if personaVarios %}
<label id="nombrePersona" for=""><span style="font-weight: bold;color: rgb(136,12,12);">Cliente: </span>{{personaVarios}}</label>
{% else %}
<label id="nombrePersona" for=""><span style="font-weight: bold;color: rgb(136,12,12);">Cliente: </span>{{factureName.0.refPersona.nombre}}</label>
{% endif %}
<div>
    <a style="font-size: small;" data-bs-toggle="modal" data-bs-target="#editName" type="button" id="editNameId" class="btn btn-primary text-white" href="javascript:void(0);">
        Editar cliente
    </a>
    <div tabindex="-1" id="editName" class="modal fade modal-dialog-scrollable" aria-labelledby="editNameLabel" aria-hidden="true">
        <div class="modal-dialog">
            <div class="modal-content">
                <div class="modal-header">
                    <h5 class="modal-title" id="editNameLabel">Editar cliente</h5>
                    <button type="button" class="btn-close" data-bs-dismiss="modal" aria-label="Close"></button>
                </div>
                <div class="modal-body"> 
                    <form id="formCust" method="POST" action="{% url 'contEditPerson' factureName.0.refPersona.id %}">
                        {% csrf_token %}
                        <div class="mb-3">
                            <label class="form-label" for="custName">Nombre</label>
                            <input value="{{factureName.0.refPersona.nombre}}" class="form-control" id="custName" type="text" name="custName" required>
                        </div>
                        <div class="mb-3">
                            <label class="form-label" for="custId">Identificación</label>
                            <input value="{{factureName.0.refPersona.documento}}" class="form-control" id="custId" type="text" name="custId">
                        </div>
                        <button type="button" class="btn btn-secondary" data-bs-dismiss="modal">Cerrar</button>
                        <button type="submit" class="btn btn-primary">Guardar</button>
                    </form>
                    
                </div>   
            </div>
        </div>
    </div>  
</div>
<div class="container mt-2">
    <input value="entrySpending" id="entrySpending" name="entrySpending" type="checkbox">
    <label for="entrySpending">Sólo facturas/mercancía por cobrar/pagar</label>
</div>

<div class="mt-2">
    <div class="col-lg-5">
        <input type="text" class="form-control" name="cod" id="cod" aria-describedby="codHelp" placeholder="Filtro... ">
    </div>
</div>

<!-- Fin del collapse -->
</div>

<div id="invoice2">
<table id="" style="font-size: small;" class="table-bordered invoice mt-2">
    <thead id="hSup">
        <tr style="background-color: #F5F087;" class="excludeFooter">
            <th class="p-2">{{factureName.0.refPersona.nombre|upper}}: Desde {{dayFrom}} hasta {{dayTo}}</th>
        </tr>
    </thead>
</table>

<table id="invoice" style="font-size: small;" class="table-bordered invoice draggable table-sortable">
    <thead id="hMain">
        <tr style="background-color: #7C8FEC;position: sticky;top: 70;" class="">
            <th style="position: sticky;top: 70;" class="p-2 include">Fecha</th>
            <th style="position: sticky;top: 70;" class="p-2 include">Cliente</th>
            <th style="position: sticky;top: 70;" class="p-2 include">Fact #</th>
            <th style="position: sticky;top: 70;" class="p-2 include">Categoría</th>
            <th style="position: sticky;top: 70;" class="p-2 include">Tipo de pago</th>
            <th style="position: sticky;top: 70;" class="p-2 include">Monto</th>
            <th id="thBalance" style="position: sticky;top: 70;" class="p-2 include">Balance</th>
            <th style="position: sticky;top: 70;" class="p-2 include">Nota</th>
            <th style="position: sticky;top: 70;" id="check" class="p-2 exclude">Acción</th>
        </tr>
    </thead>
    <tbody id="myTable">
        {% for fact in factureName %}
        {% for key,value in balance.items %}
        {% if key == fact.id %}
        <tr>
            <td {% if fact.refType.ingreso == True %}  {% if fact.nc == True %} {% if fact.refType.mercPagar == False %} style="color: #1029b9;" {% endif %} {% else %} {% if fact.refType.facCobrar == False or fact.refType.mercPagar == True %} style="color: #1029b9;" {% else %} style="color: #a00a0a;" {% endif %} {% endif %} {% else %} {% if fact.nc == True %} {% if fact.refType.mercPagar == True %} style="color: #a00a0a;" {% else %} style="color: #1029b9;" {% endif %} {% else %} {% if fact.refType.facCobrar == True or fact.refType.mercPagar == False %} style="color: #a00a0a;" {% else %} style="color: #1029b9;" {% endif %} {% endif %} {% endif %} class="p-2">{{fact.fechaCreado|date:"M d, Y"}}</td>
            <td {% if fact.refType.ingreso == True %}  {% if fact.nc == True %} {% if fact.refType.mercPagar == False %} style="color: #1029b9;" {% endif %} {% else %} {% if fact.refType.facCobrar == False or fact.refType.mercPagar == True %} style="color: #1029b9;" {% else %} style="color: #a00a0a;" {% endif %} {% endif %} {% else %} {% if fact.nc == True %} {% if fact.refType.mercPagar == True %} style="color: #a00a0a;" {% else %} style="color: #1029b9;" {% endif %} {% else %} {% if fact.refType.facCobrar == True or fact.refType.mercPagar == False %} style="color: #a00a0a;" {% else %} style="color: #1029b9;" {% endif %} {% endif %} {% endif %} class="p-2">{{fact.refPersona.nombre}}</td>
            <td {% if fact.refType.ingreso == True %}  {% if fact.nc == True %} {% if fact.refType.mercPagar == False %} style="color: #1029b9;" {% endif %} {% else %} {% if fact.refType.facCobrar == False or fact.refType.mercPagar == True %} style="color: #1029b9;" {% else %} style="color: #a00a0a;" {% endif %} {% endif %} {% else %} {% if fact.nc == True %} {% if fact.refType.mercPagar == True %} style="color: #a00a0a;" {% else %} style="color: #1029b9;" {% endif %} {% else %} {% if fact.refType.facCobrar == True or fact.refType.mercPagar == False %} style="color: #a00a0a;" {% else %} style="color: #1029b9;" {% endif %} {% endif %} {% endif %} class="p-2">{{fact.num}}</td>
            <td style="max-width: 100px;" class="p-2"><a {% if fact.refType.ingreso == True %}  {% if fact.nc == True %} {% if fact.refType.mercPagar == False %} style="color: #1029b9;" {% endif %} {% else %} {% if fact.refType.facCobrar == False or fact.refType.mercPagar == True %} style="color: #1029b9;" {% else %} style="color: #a00a0a;" {% endif %} {% endif %} {% else %} {% if fact.nc == True %} {% if fact.refType.mercPagar == True %} style="color: #a00a0a;" {% else %} style="color: #1029b9;" {% endif %} {% else %} {% if fact.refType.facCobrar == True or fact.refType.mercPagar == False %} style="color: #a00a0a;" {% else %} style="color: #1029b9;" {% endif %} {% endif %} {% endif %} href="{% url 'contListByCategory' fact.refCategory.nombre %}">{{fact.refCategory.nombre|upper}}</a></td>
            <td style="max-width: 100px;" class="p-2"><a {% if fact.refType.ingreso == True %}  {% if fact.nc == True %} {% if fact.refType.mercPagar == False %} style="color: #1029b9;" {% endif %} {% else %} {% if fact.refType.facCobrar == False or fact.refType.mercPagar == True %} style="color: #1029b9;" {% else %} style="color: #a00a0a;" {% endif %} {% endif %} {% else %} {% if fact.nc == True %} {% if fact.refType.mercPagar == True %} style="color: #a00a0a;" {% else %} style="color: #1029b9;" {% endif %} {% else %} {% if fact.refType.facCobrar == True or fact.refType.mercPagar == False %} style="color: #a00a0a;" {% else %} style="color: #1029b9;" {% endif %} {% endif %} {% endif %} href="{% url 'contListByType' fact.refType.nombre %}">{{fact.refType.nombre|upper}}</a></td>
            <td {% if fact.refType.ingreso == True %}  {% if fact.nc == True %} {% if fact.refType.mercPagar == False %} style="color: #1029b9;" {% endif %} {% else %} {% if fact.refType.facCobrar == False or fact.refType.mercPagar == True %} style="color: #1029b9;" {% else %} style="color: #a00a0a;" {% endif %} {% endif %} {% else %} {% if fact.nc == True %} {% if fact.refType.mercPagar == True %} style="color: #a00a0a;" {% else %} style="color: #1029b9;" {% endif %} {% else %} {% if fact.refType.facCobrar == True or fact.refType.mercPagar == False %} style="color: #a00a0a;" {% else %} style="color: #1029b9;" {% endif %} {% endif %} {% endif %} id="auxMonto" class="p-2"><div {% if fact.pendiente == True %} style="font-weight: bold;" {% else %} "" {% endif %}>${{value.1|stringformat:".2f"}}</div></td>
            <td {% if fact.refType.ingreso == True %}  {% if fact.nc == True %} {% if fact.refType.mercPagar == False %} style="color: #1029b9;" {% endif %} {% else %} {% if fact.refType.facCobrar == False or fact.refType.mercPagar == True %} style="color: #1029b9;" {% else %} style="color: #a00a0a;" {% endif %} {% endif %} {% else %} {% if fact.nc == True %} {% if fact.refType.mercPagar == True %} style="color: #a00a0a;" {% else %} style="color: #1029b9;" {% endif %} {% else %} {% if fact.refType.facCobrar == True or fact.refType.mercPagar == False %} style="color: #a00a0a;" {% else %} style="color: #1029b9;" {% endif %} {% endif %} {% endif %} auxCatPagada="{{fact.refCategory.nombre|upper}}" auxPendiente="{{fact.pendiente}}" auxCatCobrada="{{fact.refCategory.nombre|upper}}" auxTotal="{{value.1|floatformat:2}}" auxNc="{{fact.nc}}" auxIngreso="{{fact.refType.ingreso}}" auxCobrar="{{fact.refType.facCobrar}}" auxPagar="{{fact.refType.mercPagar}}" auxCobrada="{{fact.refType.facCobrada}}" auxPagada="{{fact.refType.mercPagada}}" id="auxBalance" class="p-2">${{value.0|stringformat:".2f"}}</td>
            <td {% if fact.refType.ingreso == True %}  {% if fact.nc == True %} {% if fact.refType.mercPagar == False %} style="color: #1029b9;" {% endif %} {% else %} {% if fact.refType.facCobrar == False or fact.refType.mercPagar == True %} style="color: #1029b9;" {% else %} style="color: #a00a0a;" {% endif %} {% endif %} {% else %} {% if fact.nc == True %} {% if fact.refType.mercPagar == True %} style="color: #a00a0a;" {% else %} style="color: #1029b9;" {% endif %} {% else %} {% if fact.refType.facCobrar == True or fact.refType.mercPagar == False %} style="color: #a00a0a;" {% else %} style="color: #1029b9;" {% endif %} {% endif %} {% endif %} style="max-width: 100px;" class="p-2">{{fact.note}}</td>
            <td id="check" class="exclude"><a style="color: white;font-size: small;" class="btn btn-secondary" href="{% url 'editeFact' fact.id request.get_full_path|cut:'/' %}">Editar</a>
                <a data-bs-toggle="modal" data-bs-target="#deleteFac{{fact.id}}" style="text-decoration: none;color: rgb(136,12,12);font-size: small;" id="deleteFacId" class="btn btn-danger text-white" href="javascript:void(0);">Eliminar</a>
            </td>
        </tr>
        <div tabindex="-1" id="deleteFac{{fact.id}}" class="modal fade modal-dialog-scrollable" aria-labelledby="deleteFacLabel{{fact.id}}" aria-hidden="true">
            <div class="modal-dialog">
                <div class="modal-content">
                    <div class="modal-header">
                    <h5 class="modal-title" id="deleteFacLabel{{fact.id}}">Precaución</h5>
                    <button type="button" class="btn-close" data-bs-dismiss="modal" aria-label="Close"></button>
                    </div>
                    <div class="modal-body">
                        ¿Seguro/a que deseas eliminar la factura {{fact.num}}?
                    </div>
                    <div class="modal-footer">
                    <button type="button" class="btn btn-secondary" data-bs-dismiss="modal">Close</button>
                    <a id="deleteFacture" class="btn btn-primary" href="{% url 'deleteFac' fact.id %}">Borrar</a>
                    </div>
                </div>
                </div>
        </div> 
        {% endif %}
        {% endfor %}
        {% endfor %}
    </tbody>
</table>
<table class="table-bordered invoice mb-2 tfoot" style="font-size: small;" id="hInf">
    <thead>
        <tr {% if acumTotal == 0 %} style="background-color: #E77C7C;" {% else %} {% if acumTotal < 0 %} style="background-color: #E77C7C;color: #c90a0a" {% else %} style="background-color: #E77C7C;color: #1029b9" {% endif %} {% endif %} class="">
            <th colspan=9 id="balanceTotal" class="p-2">TOTAL ${{acumTotal|stringformat:".2f"}}</th>
        </tr>
    </thead>
</table>
</div>
</div>

<script src="https://cdnjs.cloudflare.com/ajax/libs/pdfmake/0.2.4/pdfmake.min.js"></script>
<script src="https://cdnjs.cloudflare.com/ajax/libs/pdfmake/0.2.4/pdfmake.js"></script>
<script src="https://cdnjs.cloudflare.com/ajax/libs/pdfmake/0.2.4/pdfmake.js.map"></script>
<script src="https://cdnjs.cloudflare.com/ajax/libs/pdfmake/0.2.4/pdfmake.min.js.map"></script>
<script src="https://cdnjs.cloudflare.com/ajax/libs/pdfmake/0.2.4/vfs_fonts.js"></script>
<script src="https://cdnjs.cloudflare.com/ajax/libs/pdfmake/0.2.4/vfs_fonts.min.js"></script>
<script src="https://cdnjs.cloudflare.com/ajax/libs/pdfmake/0.2.4/fonts/Roboto/Roboto-Medium.ttf"></script>

<script type="text/javascript" src="{% static 'spareapp/html2canvas.min.js' %}"></script>

<script type="text/javascript" src="{% static 'spareapp/dragtable.js' %}"></script>

<script src="https://cdn.jsdelivr.net/gh/linways/table-to-excel@v1.0.4/dist/tableToExcel.js"></script>

<script type="text/javascript">
$("#downloadexcela").click(function(){

    var body = document.getElementsByTagName("body")[0];
    var tabla   = document.createElement("table");
    var tblBody = document.createElement("tbody");
    var tblHead = document.createElement("thead");

    $("#invoice thead tr").each(function(){
        var hilera = document.createElement("tr");
        $(this).find("th:not(#check)").each(function(){
            var celda = document.createElement("th");
            var textoCelda = document.createTextNode($(this).text());
            celda.appendChild(textoCelda);
            hilera.appendChild(celda);
        })
        tblHead.appendChild(hilera)
    })

    $("#invoice tbody tr").each(function(){
        if ($(this).is(":visible")){
            var hilera = document.createElement("tr");
            $(this).find("td:not(.exclude)").each(function(){
                if ($(this).is(":visible")){
                    var celda = document.createElement("td");
                    var textoCelda = document.createTextNode($(this).text());
                    celda.appendChild(textoCelda);
                    hilera.appendChild(celda);
                }
            })
            tblBody.appendChild(hilera)
        }
    })

    tabla.appendChild(tblHead);
    tabla.appendChild(tblBody);
    body.appendChild(tabla);
    tabla.style.display = "none"
    tabla.setAttribute("id", "prueba");

    let table = document.getElementById("prueba")

    TableToExcel.convert(table, {
        name: `export.xlsx`,
        sheet: {
        name: 'Sheet 1'
        }
    });
    $("#prueba").remove()
})
</script>

<script>
// Arreglar por click a cabecera ----------------------------------------------------------------------------------
// Se debe agregar CSS th { cursor: pointer; }
$('th').not("#check").click(function(){
    var table = $(this).parents('table').eq(0)
    var rows = table.find('tr:gt(0)').toArray().sort(comparer($(this).index()))
    this.asc = !this.asc
    if (!this.asc){rows = rows.reverse()}
    for (var i = 0; i < rows.length; i++){table.append(rows[i])}

})
function comparer(index) {
    return function(a, b) {
        var valA = getCellValue(a, index), valB = getCellValue(b, index)
        return $.isNumeric(valA) && $.isNumeric(valB) ? valA - valB : valA.toString().localeCompare(valB)
    }
}
function getCellValue(row, index){ return $(row).children('td').eq(index).text() }
</script>

<script>

$("#cod").on("keyup",function(){
    var filter = $("#cod").val().toLowerCase();
    var dateTo = $("#dateTo").val()
    var dateFrom = $("#dateFrom").val()
    var requestP = $("#requestP").val()
    var busquedaValor = $("#busquedaValor").val()
    var all = $("#search1").attr('checked')
    var month = $("#search2").attr('checked')
    var range = $("#search4").attr('checked')
    var balance = $("#search5").attr('checked')
    var soloFac = $("#entrySpending").is(':checked')
    var nombre = $("#contNombre option:selected").val()

    $.ajax({
        method: 'GET',
        url: '/filterAccountStat',
        data: {"busquedaValor":busquedaValor,"soloFac":soloFac,"nombre":nombre,"all":all,"month":month,"range":range,"balance":balance,'dateFrom':dateFrom,'dateTo':dateTo,'filter':filter},
        success:function(data){
            $("#myTable").empty()
            $(".tfoot thead").empty()
            // alert(data.cont)
            for(var i = 0; i<data.allFacturesQuery.length;i++){
                if(data.allFacturesQuery[i].pendiente == true){
                    if(data.allTypesQuery[i].refType__ingreso == true){
                        if(data.allFacturesQuery[i].nc == true){
                            if(data.allTypesQuery[i].refType__mercPagar == false){
                                $("#myTable").append("<tr><td style='color: #1029b9;' class='p-2'>"+data.dateDic[i]+"</td><td style='color: #1029b9;' class='p-2'>"+data.allTypesQuery[i].refPersona__nombre+"</td><td style='color: #1029b9;' class='p-2'>"+data.allFacturesQuery[i].num+"</td><td style='max-width: 100px;' class='p-2'><a style='color: #1029b9;' href='/contListByCategory/"+data.allCategorysQuery[i].refCategory__nombre+"'>"+data.allCategorysQuery[i].refCategory__nombre+"</a></td><td style='max-width: 100px;' class='p-2'><a style='color: #1029b9;' href='/contListByType/"+data.allTypesQuery[i].refType__nombre+"'>"+data.allTypesQuery[i].refType__nombre+"</a></td><td style='color: #1029b9;' id='auxMonto' class='p-2'><div style='font-weight: bold;'>$"+data.balance[data.allFacturesQuery[i].id][1].toFixed(2)+"</div></td><td style='color: #1029b9;' class='p-2'>$"+data.balance[data.allFacturesQuery[i].id][0].toFixed(2)+"</td><td style='color: #1029b9;' style='max-width: 100px;' class='p-2'>"+data.allFacturesQuery[i].note+"</td><td id='check' class='exclude'><a style='color: white;font-size: small;' class='btn btn-secondary mx-1' href='/editeFact/"+data.allFacturesQuery[i].id+"/accountStat'>Editar</a><a data-bs-toggle='modal' data-bs-target='#deleteFac"+data.allFacturesQuery[i].id+"' style='text-decoration: none;color: rgb(136,12,12);font-size: small;' id='deleteFacId' class='btn btn-danger text-white' href='javascript:void(0);'>Eliminar</a></td></tr>")
                                // $("#myTable").append("<tr><td style='color: #1029b9;' class='p-2'>"+data.dateDic[i]+"</td><td style='color: #1029b9;' class='p-2'>Nombre nc mercpagar</td><td style='color: #1029b9;' class='p-2'>"+data.allFacturesQuery[i].num+"</td><td style='max-width: 100px;' class='p-2'><a style='color: #1029b9;' href='/contListByCategory/"+data.allCategorysQuery[i].refCategory__nombre+"'>"+data.allCategorysQuery[i].refCategory__nombre+"</a></td><td style='max-width: 100px;' class='p-2'><a style='color: #1029b9;' href='/contListByType/"+data.allTypesQuery[i].refType__nombre+"'>"+data.allTypesQuery[i].refType__nombre+"</a></td><td style='color: #1029b9;' id='auxMonto' class='p-2'><div style='font-weight: bold;'>$"+data.balance[data.allFacturesQuery[i].id][1].toFixed(2)+"</div></td><td style='color: #1029b9;' class='p-2'>$"+data.balance[data.allFacturesQuery[i].id][0].toFixed(2)+"</td><td style='color: #1029b9;' style='max-width: 100px;' class='p-2'>"+data.allFacturesQuery[i].note+"</td><td id='check' class='exclude'><a style='color: white;font-size: small;' class='btn btn-secondary mx-1' href='/editeFact/"+data.allFacturesQuery[i].id+"/accountStat'>Editar</a><a data-bs-toggle='modal' data-bs-target='#deleteFac"+data.allFacturesQuery[i].id+"' style='text-decoration: none;color: rgb(136,12,12);font-size: small;' id='deleteFacId' class='btn btn-danger text-white' href='javascript:void(0);'>Eliminar</a></td></tr>")
                            }
                        }else{
                            if(data.allTypesQuery[i].refType__facCobrar == false | data.allTypesQuery[i].refType__mercPagar == true){
                                $("#myTable").append("<tr><td style='color: #1029b9;' class='p-2'>"+data.dateDic[i]+"</td><td style='color: #1029b9;' class='p-2'>"+data.allTypesQuery[i].refPersona__nombre+"</td><td style='color: #1029b9;' class='p-2'>"+data.allFacturesQuery[i].num+"</td><td style='max-width: 100px;' class='p-2'><a style='color: #1029b9;' href='/contListByCategory/"+data.allCategorysQuery[i].refCategory__nombre+"'>"+data.allCategorysQuery[i].refCategory__nombre+"</a></td><td style='max-width: 100px;' class='p-2'><a style='color: #1029b9;' href='/contListByType/"+data.allTypesQuery[i].refType__nombre+"'>"+data.allTypesQuery[i].refType__nombre+"</a></td><td style='color: #1029b9;' id='auxMonto' class='p-2'><div style='font-weight: bold;'>$"+data.balance[data.allFacturesQuery[i].id][1].toFixed(2)+"</div></td><td style='color: #1029b9;' class='p-2'>$"+data.balance[data.allFacturesQuery[i].id][0].toFixed(2)+"</td><td style='color: #1029b9;' style='max-width: 100px;' class='p-2'>"+data.allFacturesQuery[i].note+"</td><td id='check' class='exclude'><a style='color: white;font-size: small;' class='btn btn-secondary mx-1' href='/editeFact/"+data.allFacturesQuery[i].id+"/accountStat'>Editar</a><a data-bs-toggle='modal' data-bs-target='#deleteFac"+data.allFacturesQuery[i].id+"' style='text-decoration: none;color: rgb(136,12,12);font-size: small;' id='deleteFacId' class='btn btn-danger text-white' href='javascript:void(0);'>Eliminar</a></td></tr>")
                            }else{
                                $("#myTable").append("<tr><td style='color: #a00a0a;' class='p-2'>"+data.dateDic[i]+"</td><td style='color: #a00a0a;' class='p-2'>"+data.allTypesQuery[i].refPersona__nombre+"</td><td style='color: #a00a0a;' class='p-2'>"+data.allFacturesQuery[i].num+"</td><td style='max-width: 100px;' class='p-2'><a style='color: #a00a0a;' href='/contListByCategory/"+data.allCategorysQuery[i].refCategory__nombre+"'>"+data.allCategorysQuery[i].refCategory__nombre+"</a></td><td style='max-width: 100px;' class='p-2'><a style='color: #a00a0a;' href='/contListByType/"+data.allTypesQuery[i].refType__nombre+"'>"+data.allTypesQuery[i].refType__nombre+"</a></td><td style='color: #a00a0a;' id='auxMonto' class='p-2'><div style='font-weight: bold;'>$"+data.balance[data.allFacturesQuery[i].id][1].toFixed(2)+"</div></td><td style='color: #a00a0a;' class='p-2'>$"+data.balance[data.allFacturesQuery[i].id][0].toFixed(2)+"</td><td style='color: #a00a0a;' style='max-width: 100px;' class='p-2'>"+data.allFacturesQuery[i].note+"</td><td id='check' class='exclude'><a style='color: white;font-size: small;' class='btn btn-secondary mx-1' href='/editeFact/"+data.allFacturesQuery[i].id+"/accountStat'>Editar</a><a data-bs-toggle='modal' data-bs-target='#deleteFac"+data.allFacturesQuery[i].id+"' style='text-decoration: none;color: rgb(136,12,12);font-size: small;' id='deleteFacId' class='btn btn-danger text-white' href='javascript:void(0);'>Eliminar</a></td></tr>")
                            }
                        }
                    }else{
                        if(data.allFacturesQuery[i].nc == true){
                            if(data.allTypesQuery[i].refType__mercPagar == true){
                                $("#myTable").append("<tr><td style='color: #a00a0a;' class='p-2'>"+data.dateDic[i]+"</td><td style='color: #a00a0a;' class='p-2'>"+data.allTypesQuery[i].refPersona__nombre+"</td><td style='color: #a00a0a;' class='p-2'>"+data.allFacturesQuery[i].num+"</td><td style='max-width: 100px;' class='p-2'><a style='color: #a00a0a;' href='/contListByCategory/"+data.allCategorysQuery[i].refCategory__nombre+"'>"+data.allCategorysQuery[i].refCategory__nombre+"</a></td><td style='max-width: 100px;' class='p-2'><a style='color: #a00a0a;' href='/contListByType/"+data.allTypesQuery[i].refType__nombre+"'>"+data.allTypesQuery[i].refType__nombre+"</a></td><td style='color: #a00a0a;' id='auxMonto' class='p-2'><div style='font-weight: bold;'>$"+data.balance[data.allFacturesQuery[i].id][1].toFixed(2)+"</div></td><td style='color: #a00a0a;' class='p-2'>$"+data.balance[data.allFacturesQuery[i].id][0].toFixed(2)+"</td><td style='color: #a00a0a;' style='max-width: 100px;' class='p-2'>"+data.allFacturesQuery[i].note+"</td><td id='check' class='exclude'><a style='color: white;font-size: small;' class='btn btn-secondary mx-1' href='/editeFact/"+data.allFacturesQuery[i].id+"/accountStat'>Editar</a><a data-bs-toggle='modal' data-bs-target='#deleteFac"+data.allFacturesQuery[i].id+"' style='text-decoration: none;color: rgb(136,12,12);font-size: small;' id='deleteFacId' class='btn btn-danger text-white' href='javascript:void(0);'>Eliminar</a></td></tr>")
                            }else{
                                $("#myTable").append("<tr><td style='color: #1029b9;' class='p-2'>"+data.dateDic[i]+"</td><td style='color: #1029b9;' class='p-2'>"+data.allTypesQuery[i].refPersona__nombre+"</td><td style='color: #1029b9;' class='p-2'>"+data.allFacturesQuery[i].num+"</td><td style='max-width: 100px;' class='p-2'><a style='color: #1029b9;' href='/contListByCategory/"+data.allCategorysQuery[i].refCategory__nombre+"'>"+data.allCategorysQuery[i].refCategory__nombre+"</a></td><td style='max-width: 100px;' class='p-2'><a style='color: #1029b9;' href='/contListByType/"+data.allTypesQuery[i].refType__nombre+"'>"+data.allTypesQuery[i].refType__nombre+"</a></td><td style='color: #1029b9;' id='auxMonto' class='p-2'><div style='font-weight: bold;'>$"+data.balance[data.allFacturesQuery[i].id][1].toFixed(2)+"</div></td><td style='color: #1029b9;' class='p-2'>$"+data.balance[data.allFacturesQuery[i].id][0].toFixed(2)+"</td><td style='color: #1029b9;' style='max-width: 100px;' class='p-2'>"+data.allFacturesQuery[i].note+"</td><td id='check' class='exclude'><a style='color: white;font-size: small;' class='btn btn-secondary mx-1' href='/editeFact/"+data.allFacturesQuery[i].id+"/accountStat'>Editar</a><a data-bs-toggle='modal' data-bs-target='#deleteFac"+data.allFacturesQuery[i].id+"' style='text-decoration: none;color: rgb(136,12,12);font-size: small;' id='deleteFacId' class='btn btn-danger text-white' href='javascript:void(0);'>Eliminar</a></td></tr>")
                            }
                        }else{
                            if(data.allTypesQuery[i].refType__facCobrar == true | data.allTypesQuery[i].refType__mercPagar == false){
                                $("#myTable").append("<tr><td style='color: #a00a0a;' class='p-2'>"+data.dateDic[i]+"</td><td style='color: #a00a0a;' class='p-2'>"+data.allTypesQuery[i].refPersona__nombre+"</td><td style='color: #a00a0a;' class='p-2'>"+data.allFacturesQuery[i].num+"</td><td style='max-width: 100px;' class='p-2'><a style='color: #a00a0a;' href='/contListByCategory/"+data.allCategorysQuery[i].refCategory__nombre+"'>"+data.allCategorysQuery[i].refCategory__nombre+"</a></td><td style='max-width: 100px;' class='p-2'><a style='color: #a00a0a;' href='/contListByType/"+data.allTypesQuery[i].refType__nombre+"'>"+data.allTypesQuery[i].refType__nombre+"</a></td><td style='color: #a00a0a;' id='auxMonto' class='p-2'><div style='font-weight: bold;'>$"+data.balance[data.allFacturesQuery[i].id][1].toFixed(2)+"</div></td><td style='color: #a00a0a;' class='p-2'>$"+data.balance[data.allFacturesQuery[i].id][0].toFixed(2)+"</td><td style='color: #a00a0a;' style='max-width: 100px;' class='p-2'>"+data.allFacturesQuery[i].note+"</td><td id='check' class='exclude'><a style='color: white;font-size: small;' class='btn btn-secondary mx-1' href='/editeFact/"+data.allFacturesQuery[i].id+"/accountStat'>Editar</a><a data-bs-toggle='modal' data-bs-target='#deleteFac"+data.allFacturesQuery[i].id+"' style='text-decoration: none;color: rgb(136,12,12);font-size: small;' id='deleteFacId' class='btn btn-danger text-white' href='javascript:void(0);'>Eliminar</a></td></tr>")
                            }else{
                                $("#myTable").append("<tr><td style='color: #1029b9;' class='p-2'>"+data.dateDic[i]+"</td><td style='color: #1029b9;' class='p-2'>"+data.allTypesQuery[i].refPersona__nombre+"</td><td style='color: #1029b9;' class='p-2'>"+data.allFacturesQuery[i].num+"</td><td style='max-width: 100px;' class='p-2'><a style='color: #1029b9;' href='/contListByCategory/"+data.allCategorysQuery[i].refCategory__nombre+"'>"+data.allCategorysQuery[i].refCategory__nombre+"</a></td><td style='max-width: 100px;' class='p-2'><a style='color: #1029b9;' href='/contListByType/"+data.allTypesQuery[i].refType__nombre+"'>"+data.allTypesQuery[i].refType__nombre+"</a></td><td style='color: #1029b9;' id='auxMonto' class='p-2'><div style='font-weight: bold;'>$"+data.balance[data.allFacturesQuery[i].id][1].toFixed(2)+"</div></td><td style='color: #1029b9;' class='p-2'>$"+data.balance[data.allFacturesQuery[i].id][0].toFixed(2)+"</td><td style='color: #1029b9;' style='max-width: 100px;' class='p-2'>"+data.allFacturesQuery[i].note+"</td><td id='check' class='exclude'><a style='color: white;font-size: small;' class='btn btn-secondary mx-1' href='/editeFact/"+data.allFacturesQuery[i].id+"/accountStat'>Editar</a><a data-bs-toggle='modal' data-bs-target='#deleteFac"+data.allFacturesQuery[i].id+"' style='text-decoration: none;color: rgb(136,12,12);font-size: small;' id='deleteFacId' class='btn btn-danger text-white' href='javascript:void(0);'>Eliminar</a></td></tr>")
                            }
                        }
                    }
                }else{
                    if(data.allTypesQuery[i].refType__ingreso == true){
                        if(data.allFacturesQuery[i].nc == true){
                            if(data.allTypesQuery[i].refType__mercPagar == false){
                                $("#myTable").append("<tr><td style='color: #1029b9;' class='p-2'>"+data.dateDic[i]+"</td><td style='color: #1029b9;' class='p-2'>"+data.allTypesQuery[i].refPersona__nombre+"</td><td style='color: #1029b9;' class='p-2'>"+data.allFacturesQuery[i].num+"</td><td style='max-width: 100px;' class='p-2'><a style='color: #1029b9;' href='/contListByCategory/"+data.allCategorysQuery[i].refCategory__nombre+"'>"+data.allCategorysQuery[i].refCategory__nombre+"</a></td><td style='max-width: 100px;' class='p-2'><a style='color: #1029b9;' href='/contListByType/"+data.allTypesQuery[i].refType__nombre+"'>"+data.allTypesQuery[i].refType__nombre+"</a></td><td style='color: #1029b9;' id='auxMonto' class='p-2'><div>$"+data.balance[data.allFacturesQuery[i].id][1].toFixed(2)+"</div></td><td style='color: #1029b9;' class='p-2'>$"+data.balance[data.allFacturesQuery[i].id][0].toFixed(2)+"</td><td style='color: #1029b9;' style='max-width: 100px;' class='p-2'>"+data.allFacturesQuery[i].note+"</td><td id='check' class='exclude'><a style='color: white;font-size: small;' class='btn btn-secondary mx-1' href='/editeFact/"+data.allFacturesQuery[i].id+"/accountStat'>Editar</a><a data-bs-toggle='modal' data-bs-target='#deleteFac"+data.allFacturesQuery[i].id+"' style='text-decoration: none;color: rgb(136,12,12);font-size: small;' id='deleteFacId' class='btn btn-danger text-white' href='javascript:void(0);'>Eliminar</a></td></tr>")
                            }
                        }else{
                            if(data.allTypesQuery[i].refType__facCobrar == false | data.allTypesQuery[i].refType__mercPagar == true){
                                $("#myTable").append("<tr><td style='color: #1029b9;' class='p-2'>"+data.dateDic[i]+"</td><td style='color: #1029b9;' class='p-2'>"+data.allTypesQuery[i].refPersona__nombre+"</td><td style='color: #1029b9;' class='p-2'>"+data.allFacturesQuery[i].num+"</td><td style='max-width: 100px;' class='p-2'><a style='color: #1029b9;' href='/contListByCategory/"+data.allCategorysQuery[i].refCategory__nombre+"'>"+data.allCategorysQuery[i].refCategory__nombre+"</a></td><td style='max-width: 100px;' class='p-2'><a style='color: #1029b9;' href='/contListByType/"+data.allTypesQuery[i].refType__nombre+"'>"+data.allTypesQuery[i].refType__nombre+"</a></td><td style='color: #1029b9;' id='auxMonto' class='p-2'><div>$"+data.balance[data.allFacturesQuery[i].id][1].toFixed(2)+"</div></td><td style='color: #1029b9;' class='p-2'>$"+data.balance[data.allFacturesQuery[i].id][0].toFixed(2)+"</td><td style='color: #1029b9;' style='max-width: 100px;' class='p-2'>"+data.allFacturesQuery[i].note+"</td><td id='check' class='exclude'><a style='color: white;font-size: small;' class='btn btn-secondary mx-1' href='/editeFact/"+data.allFacturesQuery[i].id+"/accountStat'>Editar</a><a data-bs-toggle='modal' data-bs-target='#deleteFac"+data.allFacturesQuery[i].id+"' style='text-decoration: none;color: rgb(136,12,12);font-size: small;' id='deleteFacId' class='btn btn-danger text-white' href='javascript:void(0);'>Eliminar</a></td></tr>")
                            }else{
                                $("#myTable").append("<tr><td style='color: #a00a0a;' class='p-2'>"+data.dateDic[i]+"</td><td style='color: #a00a0a;' class='p-2'>"+data.allTypesQuery[i].refPersona__nombre+"</td><td style='color: #a00a0a;' class='p-2'>"+data.allFacturesQuery[i].num+"</td><td style='max-width: 100px;' class='p-2'><a style='color: #a00a0a;' href='/contListByCategory/"+data.allCategorysQuery[i].refCategory__nombre+"'>"+data.allCategorysQuery[i].refCategory__nombre+"</a></td><td style='max-width: 100px;' class='p-2'><a style='color: #a00a0a;' href='/contListByType/"+data.allTypesQuery[i].refType__nombre+"'>"+data.allTypesQuery[i].refType__nombre+"</a></td><td style='color: #a00a0a;' id='auxMonto' class='p-2'><div>$"+data.balance[data.allFacturesQuery[i].id][1].toFixed(2)+"</div></td><td style='color: #a00a0a;' class='p-2'>$"+data.balance[data.allFacturesQuery[i].id][0].toFixed(2)+"</td><td style='color: #a00a0a;' style='max-width: 100px;' class='p-2'>"+data.allFacturesQuery[i].note+"</td><td id='check' class='exclude'><a style='color: white;font-size: small;' class='btn btn-secondary mx-1' href='/editeFact/"+data.allFacturesQuery[i].id+"/accountStat'>Editar</a><a data-bs-toggle='modal' data-bs-target='#deleteFac"+data.allFacturesQuery[i].id+"' style='text-decoration: none;color: rgb(136,12,12);font-size: small;' id='deleteFacId' class='btn btn-danger text-white' href='javascript:void(0);'>Eliminar</a></td></tr>")
                            }
                        }
                    }else{
                        if(data.allFacturesQuery[i].nc == true){
                            if(data.allTypesQuery[i].refType__mercPagar == true){
                                $("#myTable").append("<tr><td style='color: #a00a0a;' class='p-2'>"+data.dateDic[i]+"</td><td style='color: #a00a0a;' class='p-2'>"+data.allTypesQuery[i].refPersona__nombre+"</td><td style='color: #a00a0a;' class='p-2'>"+data.allFacturesQuery[i].num+"</td><td style='max-width: 100px;' class='p-2'><a style='color: #a00a0a;' href='/contListByCategory/"+data.allCategorysQuery[i].refCategory__nombre+"'>"+data.allCategorysQuery[i].refCategory__nombre+"</a></td><td style='max-width: 100px;' class='p-2'><a style='color: #a00a0a;' href='/contListByType/"+data.allTypesQuery[i].refType__nombre+"'>"+data.allTypesQuery[i].refType__nombre+"</a></td><td style='color: #a00a0a;' id='auxMonto' class='p-2'><div>$"+data.balance[data.allFacturesQuery[i].id][1].toFixed(2)+"</div></td><td style='color: #a00a0a;' class='p-2'>$"+data.balance[data.allFacturesQuery[i].id][0].toFixed(2)+"</td><td style='color: #a00a0a;' style='max-width: 100px;' class='p-2'>"+data.allFacturesQuery[i].note+"</td><td id='check' class='exclude'><a style='color: white;font-size: small;' class='btn btn-secondary mx-1' href='/editeFact/"+data.allFacturesQuery[i].id+"/accountStat'>Editar</a><a data-bs-toggle='modal' data-bs-target='#deleteFac"+data.allFacturesQuery[i].id+"' style='text-decoration: none;color: rgb(136,12,12);font-size: small;' id='deleteFacId' class='btn btn-danger text-white' href='javascript:void(0);'>Eliminar</a></td></tr>")
                            }else{
                                $("#myTable").append("<tr><td style='color: #1029b9;' class='p-2'>"+data.dateDic[i]+"</td><td style='color: #1029b9;' class='p-2'>"+data.allTypesQuery[i].refPersona__nombre+"</td><td style='color: #1029b9;' class='p-2'>"+data.allFacturesQuery[i].num+"</td><td style='max-width: 100px;' class='p-2'><a style='color: #1029b9;' href='/contListByCategory/"+data.allCategorysQuery[i].refCategory__nombre+"'>"+data.allCategorysQuery[i].refCategory__nombre+"</a></td><td style='max-width: 100px;' class='p-2'><a style='color: #1029b9;' href='/contListByType/"+data.allTypesQuery[i].refType__nombre+"'>"+data.allTypesQuery[i].refType__nombre+"</a></td><td style='color: #1029b9;' id='auxMonto' class='p-2'><div>$"+data.balance[data.allFacturesQuery[i].id][1].toFixed(2)+"</div></td><td style='color: #1029b9;' class='p-2'>$"+data.balance[data.allFacturesQuery[i].id][0].toFixed(2)+"</td><td style='color: #1029b9;' style='max-width: 100px;' class='p-2'>"+data.allFacturesQuery[i].note+"</td><td id='check' class='exclude'><a style='color: white;font-size: small;' class='btn btn-secondary mx-1' href='/editeFact/"+data.allFacturesQuery[i].id+"/accountStat'>Editar</a><a data-bs-toggle='modal' data-bs-target='#deleteFac"+data.allFacturesQuery[i].id+"' style='text-decoration: none;color: rgb(136,12,12);font-size: small;' id='deleteFacId' class='btn btn-danger text-white' href='javascript:void(0);'>Eliminar</a></td></tr>")
                            }
                        }else{
                            if(data.allTypesQuery[i].refType__facCobrar == true | data.allTypesQuery[i].refType__mercPagar == false){
                                $("#myTable").append("<tr><td style='color: #a00a0a;' class='p-2'>"+data.dateDic[i]+"</td><td style='color: #a00a0a;' class='p-2'>"+data.allTypesQuery[i].refPersona__nombre+"</td><td style='color: #a00a0a;' class='p-2'>"+data.allFacturesQuery[i].num+"</td><td style='max-width: 100px;' class='p-2'><a style='color: #a00a0a;' href='/contListByCategory/"+data.allCategorysQuery[i].refCategory__nombre+"'>"+data.allCategorysQuery[i].refCategory__nombre+"</a></td><td style='max-width: 100px;' class='p-2'><a style='color: #a00a0a;' href='/contListByType/"+data.allTypesQuery[i].refType__nombre+"'>"+data.allTypesQuery[i].refType__nombre+"</a></td><td style='color: #a00a0a;' id='auxMonto' class='p-2'><div>$"+data.balance[data.allFacturesQuery[i].id][1].toFixed(2)+"</div></td><td style='color: #a00a0a;' class='p-2'>$"+data.balance[data.allFacturesQuery[i].id][0].toFixed(2)+"</td><td style='color: #a00a0a;' style='max-width: 100px;' class='p-2'>"+data.allFacturesQuery[i].note+"</td><td id='check' class='exclude'><a style='color: white;font-size: small;' class='btn btn-secondary mx-1' href='/editeFact/"+data.allFacturesQuery[i].id+"/accountStat'>Editar</a><a data-bs-toggle='modal' data-bs-target='#deleteFac"+data.allFacturesQuery[i].id+"' style='text-decoration: none;color: rgb(136,12,12);font-size: small;' id='deleteFacId' class='btn btn-danger text-white' href='javascript:void(0);'>Eliminar</a></td></tr>")
                            }else{
                                $("#myTable").append("<tr><td style='color: #1029b9;' class='p-2'>"+data.dateDic[i]+"</td><td style='color: #1029b9;' class='p-2'>"+data.allTypesQuery[i].refPersona__nombre+"</td><td style='color: #1029b9;' class='p-2'>"+data.allFacturesQuery[i].num+"</td><td style='max-width: 100px;' class='p-2'><a style='color: #1029b9;' href='/contListByCategory/"+data.allCategorysQuery[i].refCategory__nombre+"'>"+data.allCategorysQuery[i].refCategory__nombre+"</a></td><td style='max-width: 100px;' class='p-2'><a style='color: #1029b9;' href='/contListByType/"+data.allTypesQuery[i].refType__nombre+"'>"+data.allTypesQuery[i].refType__nombre+"</a></td><td style='color: #1029b9;' id='auxMonto' class='p-2'><div>$"+data.balance[data.allFacturesQuery[i].id][1].toFixed(2)+"</div></td><td style='color: #1029b9;' class='p-2'>$"+data.balance[data.allFacturesQuery[i].id][0].toFixed(2)+"</td><td style='color: #1029b9;' style='max-width: 100px;' class='p-2'>"+data.allFacturesQuery[i].note+"</td><td id='check' class='exclude'><a style='color: white;font-size: small;' class='btn btn-secondary mx-1' href='/editeFact/"+data.allFacturesQuery[i].id+"/accountStat'>Editar</a><a data-bs-toggle='modal' data-bs-target='#deleteFac"+data.allFacturesQuery[i].id+"' style='text-decoration: none;color: rgb(136,12,12);font-size: small;' id='deleteFacId' class='btn btn-danger text-white' href='javascript:void(0);'>Eliminar</a></td></tr>")
                            }
                        }
                    }
                }
            }

            if(data.acumTotal == 0){
                $(".tfoot thead").append("<tr style='background-color: #E77C7C;'><th colspan=9 id='balanceTotal' class='p-2'>TOTAL $"+data.acumTotal.toFixed(2)+"</th></tr>")
            }
            else{
                if(data.acumTotal < 0){
                    $(".tfoot thead").append("<tr style='background-color: #E77C7C;color: #c90a0a'><th colspan=9 id='balanceTotal' class='p-2'>TOTAL $"+data.acumTotal.toFixed(2)+"</th></tr>")
                }else{
                    $(".tfoot thead").append("<tr style='background-color: #E77C7C;color: #1029b9'><th colspan=9 id='balanceTotal' class='p-2'>TOTAL $"+data.acumTotal.toFixed(2)+"</th></tr>")
                }
            }
        }
    });

})

</script>

<script>

function generatePDF2(){

var tableHeaderTextSup = [...document.querySelectorAll('.excludeFooter th')].map(thElement => ({ text: thElement.textContent, style: 'tableHeaderSup' }));
var tableHeaderText = [...document.querySelectorAll('#invoice thead tr th:not(.exclude)')].map(thElement => ({ text: thElement.textContent, style: 'tableHeader' }));
var tableRowCells = [...document.querySelectorAll('#invoice tbody tr td:not(.exclude)')].map(tdElement => ({ text: tdElement.textContent, style: 'tableData' }));
var tableFooterCells = [...document.querySelectorAll('.tfoot tr th:not(.exclude)')].map(thElement => ({ text: thElement.textContent, style: 'tableFooter' }));
var rows = []
var fila = []
var footerFooter = []
var footerAux = []
var cont = 0

$("#myTable tr:not(.tfoot").each(function(){
    if ($(this).is(":visible")){
        $(this).find("td:not(.exclude)").each(function(){
            fila.push($(this).text())
            cont = cont + 1
        })
        if ((cont==tableHeaderText.length)){
            rows.push(fila)
            fila = []
            cont = 0
        }
    }
})

var aux = ""
for (m in tableFooterCells){
    aux = tableFooterCells[m].text
}
var separar = aux.split("$")

for (m in tableHeaderText){

    if (m == 0){
        footerAux.push("BALANCE")
    }
    else{
        if (tableHeaderText[m].text === "Monto"){
            footerAux.push("$"+separar[1])
        }
        else{
            footerAux.push("")
        }
    }
    
}
footerFooter.push(footerAux)

var docDefinition = {
  content: [
    {
      layout: 'lightHorizontalLines', // optional
      style: 'tableExample',
      table: {
        headerRows: 2,
        body: [
        [{text: tableHeaderTextSup[0].text, colSpan: 8},"","","","","","",""],
        tableHeaderText,
        ...rows,
        ...footerFooter,
        ],
      },
      layout: {

          fillColor: function(rowIndex) {
            if (rowIndex === 0) {
              return '#F5F087';
            }
            if (rowIndex === 1) {
              return '#7C8FEC';
            }
            if (rowIndex === (rows.length + 2)) {
                return '#E77C7C';
            }
            return (rowIndex % 2 === 0) ? '#f2f2f2' : null;
          }
        },
    },
  ],
    styles: {
        tableExample: {
            // margin: [0, 20, 0, 80],
            margin: [0, 1, 0, 1],
            fontSize: 8,
        },
        tableHeaderSup: {
            margin: 1,
            color: 'black',
            fontSize: 8,
        },
        tableHeader: {
            margin: 1,
            color: 'black',
            fontSize: 8,
        },
        tableData: {
            margin: 1,
            // fontSize: 10,
        },
        fuente: {
            margin: 1,
            fontSize: 8,
        },
        tableFooter: {
            margin: 1,
            color: 'black',
            fontSize: 8,
        },
    },
};

var nombrePersona = $("#nombrePersona").text()

pdfMake.createPdf(docDefinition).download(nombrePersona);

}

var vec = []
var i = 0
$("tbody tr").each(function(){
    $(this).find("td").each(function(){
        if($(this).attr("id")=="auxBalance"){
            vec[i] = $(this).text()
            i = i + 1
        }
    })
})
var auxMonto = $("#auxMonto").text()
var auxBalance = $("#auxBalance").text()
// Filtro de Sólo facturas/mercancía por cobrar/pagar
$("#entrySpending").change(function(){
    var filter = $("#cod").val().toLowerCase();
    var dateTo = $("#dateTo").val()
    var dateFrom = $("#dateFrom").val()
    var busquedaValor = $("#busquedaValor").val()
    var requestP = $("#requestP").val()
    var all = $("#search1").attr('checked')
    var month = $("#search2").attr('checked')
    var range = $("#search4").attr('checked')
    var balance = $("#search5").attr('checked')
    var soloFac = $("#entrySpending").is(':checked')
    var nombre = $("#contNombre option:selected").val()

    $.ajax({
        method: 'GET',
        url: '/filterAccountStat',
        data: {"busquedaValor":busquedaValor,"soloFac":soloFac,"nombre":nombre,"all":all,"month":month,"range":range,"balance":balance,'dateFrom':dateFrom,'dateTo':dateTo,'filter':filter},
        success:function(data){
            $("#myTable").empty()
            $(".tfoot thead").empty()
            // alert(data.cont)
            for(var i = 0; i<data.allFacturesQuery.length;i++){
                if(data.allFacturesQuery[i].pendiente == true){
                    if(data.allTypesQuery[i].refType__ingreso == true){
                        if(data.allFacturesQuery[i].nc == true){
                            if(data.allTypesQuery[i].refType__mercPagar == false){
                                $("#myTable").append("<tr><td style='color: #1029b9;' class='p-2'>"+data.dateDic[i]+"</td><td style='color: #1029b9;' class='p-2'>"+data.allTypesQuery[i].refPersona__nombre+"</td><td style='color: #1029b9;' class='p-2'>"+data.allFacturesQuery[i].num+"</td><td style='max-width: 100px;' class='p-2'><a style='color: #1029b9;' href='/contListByCategory/"+data.allCategorysQuery[i].refCategory__nombre+"'>"+data.allCategorysQuery[i].refCategory__nombre+"</a></td><td style='max-width: 100px;' class='p-2'><a style='color: #1029b9;' href='/contListByType/"+data.allTypesQuery[i].refType__nombre+"'>"+data.allTypesQuery[i].refType__nombre+"</a></td><td style='color: #1029b9;' id='auxMonto' class='p-2'><div style='font-weight: bold;'>$"+data.balance[data.allFacturesQuery[i].id][1].toFixed(2)+"</div></td><td style='color: #1029b9;' class='p-2'>$"+data.balance[data.allFacturesQuery[i].id][0].toFixed(2)+"</td><td style='color: #1029b9;' style='max-width: 100px;' class='p-2'>"+data.allFacturesQuery[i].note+"</td><td id='check' class='exclude'><a style='color: white;font-size: small;' class='btn btn-secondary mx-1' href='/editeFact/"+data.allFacturesQuery[i].id+"/accountStat'>Editar</a><a data-bs-toggle='modal' data-bs-target='#deleteFac"+data.allFacturesQuery[i].id+"' style='text-decoration: none;color: rgb(136,12,12);font-size: small;' id='deleteFacId' class='btn btn-danger text-white' href='javascript:void(0);'>Eliminar</a></td></tr>")
                                // $("#myTable").append("<tr><td style='color: #1029b9;' class='p-2'>"+data.dateDic[i]+"</td><td style='color: #1029b9;' class='p-2'>Nombre nc mercpagar</td><td style='color: #1029b9;' class='p-2'>"+data.allFacturesQuery[i].num+"</td><td style='max-width: 100px;' class='p-2'><a style='color: #1029b9;' href='/contListByCategory/"+data.allCategorysQuery[i].refCategory__nombre+"'>"+data.allCategorysQuery[i].refCategory__nombre+"</a></td><td style='max-width: 100px;' class='p-2'><a style='color: #1029b9;' href='/contListByType/"+data.allTypesQuery[i].refType__nombre+"'>"+data.allTypesQuery[i].refType__nombre+"</a></td><td style='color: #1029b9;' id='auxMonto' class='p-2'><div style='font-weight: bold;'>$"+data.balance[data.allFacturesQuery[i].id][1].toFixed(2)+"</div></td><td style='color: #1029b9;' class='p-2'>$"+data.balance[data.allFacturesQuery[i].id][0].toFixed(2)+"</td><td style='color: #1029b9;' style='max-width: 100px;' class='p-2'>"+data.allFacturesQuery[i].note+"</td><td id='check' class='exclude'><a style='color: white;font-size: small;' class='btn btn-secondary mx-1' href='/editeFact/"+data.allFacturesQuery[i].id+"/accountStat'>Editar</a><a data-bs-toggle='modal' data-bs-target='#deleteFac"+data.allFacturesQuery[i].id+"' style='text-decoration: none;color: rgb(136,12,12);font-size: small;' id='deleteFacId' class='btn btn-danger text-white' href='javascript:void(0);'>Eliminar</a></td></tr>")
                            }
                        }else{
                            if(data.allTypesQuery[i].refType__facCobrar == false | data.allTypesQuery[i].refType__mercPagar == true){
                                $("#myTable").append("<tr><td style='color: #1029b9;' class='p-2'>"+data.dateDic[i]+"</td><td style='color: #1029b9;' class='p-2'>"+data.allTypesQuery[i].refPersona__nombre+"</td><td style='color: #1029b9;' class='p-2'>"+data.allFacturesQuery[i].num+"</td><td style='max-width: 100px;' class='p-2'><a style='color: #1029b9;' href='/contListByCategory/"+data.allCategorysQuery[i].refCategory__nombre+"'>"+data.allCategorysQuery[i].refCategory__nombre+"</a></td><td style='max-width: 100px;' class='p-2'><a style='color: #1029b9;' href='/contListByType/"+data.allTypesQuery[i].refType__nombre+"'>"+data.allTypesQuery[i].refType__nombre+"</a></td><td style='color: #1029b9;' id='auxMonto' class='p-2'><div style='font-weight: bold;'>$"+data.balance[data.allFacturesQuery[i].id][1].toFixed(2)+"</div></td><td style='color: #1029b9;' class='p-2'>$"+data.balance[data.allFacturesQuery[i].id][0].toFixed(2)+"</td><td style='color: #1029b9;' style='max-width: 100px;' class='p-2'>"+data.allFacturesQuery[i].note+"</td><td id='check' class='exclude'><a style='color: white;font-size: small;' class='btn btn-secondary mx-1' href='/editeFact/"+data.allFacturesQuery[i].id+"/accountStat'>Editar</a><a data-bs-toggle='modal' data-bs-target='#deleteFac"+data.allFacturesQuery[i].id+"' style='text-decoration: none;color: rgb(136,12,12);font-size: small;' id='deleteFacId' class='btn btn-danger text-white' href='javascript:void(0);'>Eliminar</a></td></tr>")
                            }else{
                                $("#myTable").append("<tr><td style='color: #a00a0a;' class='p-2'>"+data.dateDic[i]+"</td><td style='color: #a00a0a;' class='p-2'>"+data.allTypesQuery[i].refPersona__nombre+"</td><td style='color: #a00a0a;' class='p-2'>"+data.allFacturesQuery[i].num+"</td><td style='max-width: 100px;' class='p-2'><a style='color: #a00a0a;' href='/contListByCategory/"+data.allCategorysQuery[i].refCategory__nombre+"'>"+data.allCategorysQuery[i].refCategory__nombre+"</a></td><td style='max-width: 100px;' class='p-2'><a style='color: #a00a0a;' href='/contListByType/"+data.allTypesQuery[i].refType__nombre+"'>"+data.allTypesQuery[i].refType__nombre+"</a></td><td style='color: #a00a0a;' id='auxMonto' class='p-2'><div style='font-weight: bold;'>$"+data.balance[data.allFacturesQuery[i].id][1].toFixed(2)+"</div></td><td style='color: #a00a0a;' class='p-2'>$"+data.balance[data.allFacturesQuery[i].id][0].toFixed(2)+"</td><td style='color: #a00a0a;' style='max-width: 100px;' class='p-2'>"+data.allFacturesQuery[i].note+"</td><td id='check' class='exclude'><a style='color: white;font-size: small;' class='btn btn-secondary mx-1' href='/editeFact/"+data.allFacturesQuery[i].id+"/accountStat'>Editar</a><a data-bs-toggle='modal' data-bs-target='#deleteFac"+data.allFacturesQuery[i].id+"' style='text-decoration: none;color: rgb(136,12,12);font-size: small;' id='deleteFacId' class='btn btn-danger text-white' href='javascript:void(0);'>Eliminar</a></td></tr>")
                            }
                        }
                    }else{
                        if(data.allFacturesQuery[i].nc == true){
                            if(data.allTypesQuery[i].refType__mercPagar == true){
                                $("#myTable").append("<tr><td style='color: #a00a0a;' class='p-2'>"+data.dateDic[i]+"</td><td style='color: #a00a0a;' class='p-2'>"+data.allTypesQuery[i].refPersona__nombre+"</td><td style='color: #a00a0a;' class='p-2'>"+data.allFacturesQuery[i].num+"</td><td style='max-width: 100px;' class='p-2'><a style='color: #a00a0a;' href='/contListByCategory/"+data.allCategorysQuery[i].refCategory__nombre+"'>"+data.allCategorysQuery[i].refCategory__nombre+"</a></td><td style='max-width: 100px;' class='p-2'><a style='color: #a00a0a;' href='/contListByType/"+data.allTypesQuery[i].refType__nombre+"'>"+data.allTypesQuery[i].refType__nombre+"</a></td><td style='color: #a00a0a;' id='auxMonto' class='p-2'><div style='font-weight: bold;'>$"+data.balance[data.allFacturesQuery[i].id][1].toFixed(2)+"</div></td><td style='color: #a00a0a;' class='p-2'>$"+data.balance[data.allFacturesQuery[i].id][0].toFixed(2)+"</td><td style='color: #a00a0a;' style='max-width: 100px;' class='p-2'>"+data.allFacturesQuery[i].note+"</td><td id='check' class='exclude'><a style='color: white;font-size: small;' class='btn btn-secondary mx-1' href='/editeFact/"+data.allFacturesQuery[i].id+"/accountStat'>Editar</a><a data-bs-toggle='modal' data-bs-target='#deleteFac"+data.allFacturesQuery[i].id+"' style='text-decoration: none;color: rgb(136,12,12);font-size: small;' id='deleteFacId' class='btn btn-danger text-white' href='javascript:void(0);'>Eliminar</a></td></tr>")
                            }else{
                                $("#myTable").append("<tr><td style='color: #1029b9;' class='p-2'>"+data.dateDic[i]+"</td><td style='color: #1029b9;' class='p-2'>"+data.allTypesQuery[i].refPersona__nombre+"</td><td style='color: #1029b9;' class='p-2'>"+data.allFacturesQuery[i].num+"</td><td style='max-width: 100px;' class='p-2'><a style='color: #1029b9;' href='/contListByCategory/"+data.allCategorysQuery[i].refCategory__nombre+"'>"+data.allCategorysQuery[i].refCategory__nombre+"</a></td><td style='max-width: 100px;' class='p-2'><a style='color: #1029b9;' href='/contListByType/"+data.allTypesQuery[i].refType__nombre+"'>"+data.allTypesQuery[i].refType__nombre+"</a></td><td style='color: #1029b9;' id='auxMonto' class='p-2'><div style='font-weight: bold;'>$"+data.balance[data.allFacturesQuery[i].id][1].toFixed(2)+"</div></td><td style='color: #1029b9;' class='p-2'>$"+data.balance[data.allFacturesQuery[i].id][0].toFixed(2)+"</td><td style='color: #1029b9;' style='max-width: 100px;' class='p-2'>"+data.allFacturesQuery[i].note+"</td><td id='check' class='exclude'><a style='color: white;font-size: small;' class='btn btn-secondary mx-1' href='/editeFact/"+data.allFacturesQuery[i].id+"/accountStat'>Editar</a><a data-bs-toggle='modal' data-bs-target='#deleteFac"+data.allFacturesQuery[i].id+"' style='text-decoration: none;color: rgb(136,12,12);font-size: small;' id='deleteFacId' class='btn btn-danger text-white' href='javascript:void(0);'>Eliminar</a></td></tr>")
                            }
                        }else{
                            if(data.allTypesQuery[i].refType__facCobrar == true | data.allTypesQuery[i].refType__mercPagar == false){
                                $("#myTable").append("<tr><td style='color: #a00a0a;' class='p-2'>"+data.dateDic[i]+"</td><td style='color: #a00a0a;' class='p-2'>"+data.allTypesQuery[i].refPersona__nombre+"</td><td style='color: #a00a0a;' class='p-2'>"+data.allFacturesQuery[i].num+"</td><td style='max-width: 100px;' class='p-2'><a style='color: #a00a0a;' href='/contListByCategory/"+data.allCategorysQuery[i].refCategory__nombre+"'>"+data.allCategorysQuery[i].refCategory__nombre+"</a></td><td style='max-width: 100px;' class='p-2'><a style='color: #a00a0a;' href='/contListByType/"+data.allTypesQuery[i].refType__nombre+"'>"+data.allTypesQuery[i].refType__nombre+"</a></td><td style='color: #a00a0a;' id='auxMonto' class='p-2'><div style='font-weight: bold;'>$"+data.balance[data.allFacturesQuery[i].id][1].toFixed(2)+"</div></td><td style='color: #a00a0a;' class='p-2'>$"+data.balance[data.allFacturesQuery[i].id][0].toFixed(2)+"</td><td style='color: #a00a0a;' style='max-width: 100px;' class='p-2'>"+data.allFacturesQuery[i].note+"</td><td id='check' class='exclude'><a style='color: white;font-size: small;' class='btn btn-secondary mx-1' href='/editeFact/"+data.allFacturesQuery[i].id+"/accountStat'>Editar</a><a data-bs-toggle='modal' data-bs-target='#deleteFac"+data.allFacturesQuery[i].id+"' style='text-decoration: none;color: rgb(136,12,12);font-size: small;' id='deleteFacId' class='btn btn-danger text-white' href='javascript:void(0);'>Eliminar</a></td></tr>")
                            }else{
                                $("#myTable").append("<tr><td style='color: #1029b9;' class='p-2'>"+data.dateDic[i]+"</td><td style='color: #1029b9;' class='p-2'>"+data.allTypesQuery[i].refPersona__nombre+"</td><td style='color: #1029b9;' class='p-2'>"+data.allFacturesQuery[i].num+"</td><td style='max-width: 100px;' class='p-2'><a style='color: #1029b9;' href='/contListByCategory/"+data.allCategorysQuery[i].refCategory__nombre+"'>"+data.allCategorysQuery[i].refCategory__nombre+"</a></td><td style='max-width: 100px;' class='p-2'><a style='color: #1029b9;' href='/contListByType/"+data.allTypesQuery[i].refType__nombre+"'>"+data.allTypesQuery[i].refType__nombre+"</a></td><td style='color: #1029b9;' id='auxMonto' class='p-2'><div style='font-weight: bold;'>$"+data.balance[data.allFacturesQuery[i].id][1].toFixed(2)+"</div></td><td style='color: #1029b9;' class='p-2'>$"+data.balance[data.allFacturesQuery[i].id][0].toFixed(2)+"</td><td style='color: #1029b9;' style='max-width: 100px;' class='p-2'>"+data.allFacturesQuery[i].note+"</td><td id='check' class='exclude'><a style='color: white;font-size: small;' class='btn btn-secondary mx-1' href='/editeFact/"+data.allFacturesQuery[i].id+"/accountStat'>Editar</a><a data-bs-toggle='modal' data-bs-target='#deleteFac"+data.allFacturesQuery[i].id+"' style='text-decoration: none;color: rgb(136,12,12);font-size: small;' id='deleteFacId' class='btn btn-danger text-white' href='javascript:void(0);'>Eliminar</a></td></tr>")
                            }
                        }
                    }
                }else{
                    if(data.allTypesQuery[i].refType__ingreso == true){
                        if(data.allFacturesQuery[i].nc == true){
                            if(data.allTypesQuery[i].refType__mercPagar == false){
                                $("#myTable").append("<tr><td style='color: #1029b9;' class='p-2'>"+data.dateDic[i]+"</td><td style='color: #1029b9;' class='p-2'>"+data.allTypesQuery[i].refPersona__nombre+"</td><td style='color: #1029b9;' class='p-2'>"+data.allFacturesQuery[i].num+"</td><td style='max-width: 100px;' class='p-2'><a style='color: #1029b9;' href='/contListByCategory/"+data.allCategorysQuery[i].refCategory__nombre+"'>"+data.allCategorysQuery[i].refCategory__nombre+"</a></td><td style='max-width: 100px;' class='p-2'><a style='color: #1029b9;' href='/contListByType/"+data.allTypesQuery[i].refType__nombre+"'>"+data.allTypesQuery[i].refType__nombre+"</a></td><td style='color: #1029b9;' id='auxMonto' class='p-2'><div>$"+data.balance[data.allFacturesQuery[i].id][1].toFixed(2)+"</div></td><td style='color: #1029b9;' class='p-2'>$"+data.balance[data.allFacturesQuery[i].id][0].toFixed(2)+"</td><td style='color: #1029b9;' style='max-width: 100px;' class='p-2'>"+data.allFacturesQuery[i].note+"</td><td id='check' class='exclude'><a style='color: white;font-size: small;' class='btn btn-secondary mx-1' href='/editeFact/"+data.allFacturesQuery[i].id+"/accountStat'>Editar</a><a data-bs-toggle='modal' data-bs-target='#deleteFac"+data.allFacturesQuery[i].id+"' style='text-decoration: none;color: rgb(136,12,12);font-size: small;' id='deleteFacId' class='btn btn-danger text-white' href='javascript:void(0);'>Eliminar</a></td></tr>")
                            }
                        }else{
                            if(data.allTypesQuery[i].refType__facCobrar == false | data.allTypesQuery[i].refType__mercPagar == true){
                                $("#myTable").append("<tr><td style='color: #1029b9;' class='p-2'>"+data.dateDic[i]+"</td><td style='color: #1029b9;' class='p-2'>"+data.allTypesQuery[i].refPersona__nombre+"</td><td style='color: #1029b9;' class='p-2'>"+data.allFacturesQuery[i].num+"</td><td style='max-width: 100px;' class='p-2'><a style='color: #1029b9;' href='/contListByCategory/"+data.allCategorysQuery[i].refCategory__nombre+"'>"+data.allCategorysQuery[i].refCategory__nombre+"</a></td><td style='max-width: 100px;' class='p-2'><a style='color: #1029b9;' href='/contListByType/"+data.allTypesQuery[i].refType__nombre+"'>"+data.allTypesQuery[i].refType__nombre+"</a></td><td style='color: #1029b9;' id='auxMonto' class='p-2'><div>$"+data.balance[data.allFacturesQuery[i].id][1].toFixed(2)+"</div></td><td style='color: #1029b9;' class='p-2'>$"+data.balance[data.allFacturesQuery[i].id][0].toFixed(2)+"</td><td style='color: #1029b9;' style='max-width: 100px;' class='p-2'>"+data.allFacturesQuery[i].note+"</td><td id='check' class='exclude'><a style='color: white;font-size: small;' class='btn btn-secondary mx-1' href='/editeFact/"+data.allFacturesQuery[i].id+"/accountStat'>Editar</a><a data-bs-toggle='modal' data-bs-target='#deleteFac"+data.allFacturesQuery[i].id+"' style='text-decoration: none;color: rgb(136,12,12);font-size: small;' id='deleteFacId' class='btn btn-danger text-white' href='javascript:void(0);'>Eliminar</a></td></tr>")
                            }else{
                                $("#myTable").append("<tr><td style='color: #a00a0a;' class='p-2'>"+data.dateDic[i]+"</td><td style='color: #a00a0a;' class='p-2'>"+data.allTypesQuery[i].refPersona__nombre+"</td><td style='color: #a00a0a;' class='p-2'>"+data.allFacturesQuery[i].num+"</td><td style='max-width: 100px;' class='p-2'><a style='color: #a00a0a;' href='/contListByCategory/"+data.allCategorysQuery[i].refCategory__nombre+"'>"+data.allCategorysQuery[i].refCategory__nombre+"</a></td><td style='max-width: 100px;' class='p-2'><a style='color: #a00a0a;' href='/contListByType/"+data.allTypesQuery[i].refType__nombre+"'>"+data.allTypesQuery[i].refType__nombre+"</a></td><td style='color: #a00a0a;' id='auxMonto' class='p-2'><div>$"+data.balance[data.allFacturesQuery[i].id][1].toFixed(2)+"</div></td><td style='color: #a00a0a;' class='p-2'>$"+data.balance[data.allFacturesQuery[i].id][0].toFixed(2)+"</td><td style='color: #a00a0a;' style='max-width: 100px;' class='p-2'>"+data.allFacturesQuery[i].note+"</td><td id='check' class='exclude'><a style='color: white;font-size: small;' class='btn btn-secondary mx-1' href='/editeFact/"+data.allFacturesQuery[i].id+"/accountStat'>Editar</a><a data-bs-toggle='modal' data-bs-target='#deleteFac"+data.allFacturesQuery[i].id+"' style='text-decoration: none;color: rgb(136,12,12);font-size: small;' id='deleteFacId' class='btn btn-danger text-white' href='javascript:void(0);'>Eliminar</a></td></tr>")
                            }
                        }
                    }else{
                        if(data.allFacturesQuery[i].nc == true){
                            if(data.allTypesQuery[i].refType__mercPagar == true){
                                $("#myTable").append("<tr><td style='color: #a00a0a;' class='p-2'>"+data.dateDic[i]+"</td><td style='color: #a00a0a;' class='p-2'>"+data.allTypesQuery[i].refPersona__nombre+"</td><td style='color: #a00a0a;' class='p-2'>"+data.allFacturesQuery[i].num+"</td><td style='max-width: 100px;' class='p-2'><a style='color: #a00a0a;' href='/contListByCategory/"+data.allCategorysQuery[i].refCategory__nombre+"'>"+data.allCategorysQuery[i].refCategory__nombre+"</a></td><td style='max-width: 100px;' class='p-2'><a style='color: #a00a0a;' href='/contListByType/"+data.allTypesQuery[i].refType__nombre+"'>"+data.allTypesQuery[i].refType__nombre+"</a></td><td style='color: #a00a0a;' id='auxMonto' class='p-2'><div>$"+data.balance[data.allFacturesQuery[i].id][1].toFixed(2)+"</div></td><td style='color: #a00a0a;' class='p-2'>$"+data.balance[data.allFacturesQuery[i].id][0].toFixed(2)+"</td><td style='color: #a00a0a;' style='max-width: 100px;' class='p-2'>"+data.allFacturesQuery[i].note+"</td><td id='check' class='exclude'><a style='color: white;font-size: small;' class='btn btn-secondary mx-1' href='/editeFact/"+data.allFacturesQuery[i].id+"/accountStat'>Editar</a><a data-bs-toggle='modal' data-bs-target='#deleteFac"+data.allFacturesQuery[i].id+"' style='text-decoration: none;color: rgb(136,12,12);font-size: small;' id='deleteFacId' class='btn btn-danger text-white' href='javascript:void(0);'>Eliminar</a></td></tr>")
                            }else{
                                $("#myTable").append("<tr><td style='color: #1029b9;' class='p-2'>"+data.dateDic[i]+"</td><td style='color: #1029b9;' class='p-2'>"+data.allTypesQuery[i].refPersona__nombre+"</td><td style='color: #1029b9;' class='p-2'>"+data.allFacturesQuery[i].num+"</td><td style='max-width: 100px;' class='p-2'><a style='color: #1029b9;' href='/contListByCategory/"+data.allCategorysQuery[i].refCategory__nombre+"'>"+data.allCategorysQuery[i].refCategory__nombre+"</a></td><td style='max-width: 100px;' class='p-2'><a style='color: #1029b9;' href='/contListByType/"+data.allTypesQuery[i].refType__nombre+"'>"+data.allTypesQuery[i].refType__nombre+"</a></td><td style='color: #1029b9;' id='auxMonto' class='p-2'><div>$"+data.balance[data.allFacturesQuery[i].id][1].toFixed(2)+"</div></td><td style='color: #1029b9;' class='p-2'>$"+data.balance[data.allFacturesQuery[i].id][0].toFixed(2)+"</td><td style='color: #1029b9;' style='max-width: 100px;' class='p-2'>"+data.allFacturesQuery[i].note+"</td><td id='check' class='exclude'><a style='color: white;font-size: small;' class='btn btn-secondary mx-1' href='/editeFact/"+data.allFacturesQuery[i].id+"/accountStat'>Editar</a><a data-bs-toggle='modal' data-bs-target='#deleteFac"+data.allFacturesQuery[i].id+"' style='text-decoration: none;color: rgb(136,12,12);font-size: small;' id='deleteFacId' class='btn btn-danger text-white' href='javascript:void(0);'>Eliminar</a></td></tr>")
                            }
                        }else{
                            if(data.allTypesQuery[i].refType__facCobrar == true | data.allTypesQuery[i].refType__mercPagar == false){
                                $("#myTable").append("<tr><td style='color: #a00a0a;' class='p-2'>"+data.dateDic[i]+"</td><td style='color: #a00a0a;' class='p-2'>"+data.allTypesQuery[i].refPersona__nombre+"</td><td style='color: #a00a0a;' class='p-2'>"+data.allFacturesQuery[i].num+"</td><td style='max-width: 100px;' class='p-2'><a style='color: #a00a0a;' href='/contListByCategory/"+data.allCategorysQuery[i].refCategory__nombre+"'>"+data.allCategorysQuery[i].refCategory__nombre+"</a></td><td style='max-width: 100px;' class='p-2'><a style='color: #a00a0a;' href='/contListByType/"+data.allTypesQuery[i].refType__nombre+"'>"+data.allTypesQuery[i].refType__nombre+"</a></td><td style='color: #a00a0a;' id='auxMonto' class='p-2'><div>$"+data.balance[data.allFacturesQuery[i].id][1].toFixed(2)+"</div></td><td style='color: #a00a0a;' class='p-2'>$"+data.balance[data.allFacturesQuery[i].id][0].toFixed(2)+"</td><td style='color: #a00a0a;' style='max-width: 100px;' class='p-2'>"+data.allFacturesQuery[i].note+"</td><td id='check' class='exclude'><a style='color: white;font-size: small;' class='btn btn-secondary mx-1' href='/editeFact/"+data.allFacturesQuery[i].id+"/accountStat'>Editar</a><a data-bs-toggle='modal' data-bs-target='#deleteFac"+data.allFacturesQuery[i].id+"' style='text-decoration: none;color: rgb(136,12,12);font-size: small;' id='deleteFacId' class='btn btn-danger text-white' href='javascript:void(0);'>Eliminar</a></td></tr>")
                            }else{
                                $("#myTable").append("<tr><td style='color: #1029b9;' class='p-2'>"+data.dateDic[i]+"</td><td style='color: #1029b9;' class='p-2'>"+data.allTypesQuery[i].refPersona__nombre+"</td><td style='color: #1029b9;' class='p-2'>"+data.allFacturesQuery[i].num+"</td><td style='max-width: 100px;' class='p-2'><a style='color: #1029b9;' href='/contListByCategory/"+data.allCategorysQuery[i].refCategory__nombre+"'>"+data.allCategorysQuery[i].refCategory__nombre+"</a></td><td style='max-width: 100px;' class='p-2'><a style='color: #1029b9;' href='/contListByType/"+data.allTypesQuery[i].refType__nombre+"'>"+data.allTypesQuery[i].refType__nombre+"</a></td><td style='color: #1029b9;' id='auxMonto' class='p-2'><div>$"+data.balance[data.allFacturesQuery[i].id][1].toFixed(2)+"</div></td><td style='color: #1029b9;' class='p-2'>$"+data.balance[data.allFacturesQuery[i].id][0].toFixed(2)+"</td><td style='color: #1029b9;' style='max-width: 100px;' class='p-2'>"+data.allFacturesQuery[i].note+"</td><td id='check' class='exclude'><a style='color: white;font-size: small;' class='btn btn-secondary mx-1' href='/editeFact/"+data.allFacturesQuery[i].id+"/accountStat'>Editar</a><a data-bs-toggle='modal' data-bs-target='#deleteFac"+data.allFacturesQuery[i].id+"' style='text-decoration: none;color: rgb(136,12,12);font-size: small;' id='deleteFacId' class='btn btn-danger text-white' href='javascript:void(0);'>Eliminar</a></td></tr>")
                            }
                        }
                    }
                }
            }

            if(data.acumTotal == 0){
                $(".tfoot thead").append("<tr style='background-color: #E77C7C;'><th colspan=9 id='balanceTotal' class='p-2'>TOTAL $"+data.acumTotal.toFixed(2)+"</th></tr>")
            }
            else{
                if(data.acumTotal < 0){
                    $(".tfoot thead").append("<tr style='background-color: #E77C7C;color: #c90a0a'><th colspan=9 id='balanceTotal' class='p-2'>TOTAL $"+data.acumTotal.toFixed(2)+"</th></tr>")
                }else{
                    $(".tfoot thead").append("<tr style='background-color: #E77C7C;color: #1029b9'><th colspan=9 id='balanceTotal' class='p-2'>TOTAL $"+data.acumTotal.toFixed(2)+"</th></tr>")
                }
            }
        }
    });
})

$("input[name=search]").change(function(){

    if ($(this).val() == "all"){
        var all = $("#search1").attr('checked','checked')
        var month = $("#search2").attr('checked',false)
        var range = $("#search4").attr('checked',false)
        var balance = $("#search5").attr('checked',false)
    }else{
        if ($(this).val() == "month"){
            var month = $("#search2").attr('checked',false)
            var range = $("#search4").attr('checked',false)
            var balance = $("#search5").attr('checked',false)
            var month = $("#search2").attr('checked','checked')
        }else{
            if ($(this).val() == "range"){
                var all = $("#search1").attr('checked',false)
                var month = $("#search2").attr('checked',false)
                var balance = $("#search5").attr('checked',false)
                var range = $("#search4").attr('checked','checked')
            }else{
                if ($(this).val() == "balance"){
                    var all = $("#search1").attr('checked',false)
                    var month = $("#search2").attr('checked',false)
                    var range = $("#search4").attr('checked',false)
                    var balance = $("#search5").attr('checked','checked')
                }
            }
        }
    }
    var all = $("#search1").attr('checked')
    var month = $("#search2").attr('checked')
    var range = $("#search4").attr('checked')
    var busquedaValor = $("#busquedaValor").val()
    var balance = $("#search5").attr('checked')
    var filter = $("#cod").val().toLowerCase();
    var dateTo = $("#dateTo").val()
    var dateFrom = $("#dateFrom").val()
    var requestP = $("#requestP").val()
    var soloFac = $("#entrySpending").is(':checked')
    var nombre = $("#contNombre option:selected").val()

    $.ajax({
        method: 'GET',
        url: '/filterAccountStat',
        data: {"busquedaValor":busquedaValor,"soloFac":soloFac,"nombre":nombre,"all":all,"month":month,"range":range,"balance":balance,'dateFrom':dateFrom,'dateTo':dateTo,'filter':filter},
        success:function(data){
            $("#myTable").empty()
            $(".tfoot thead").empty()
            for(var i = 0; i<data.allFacturesQuery.length;i++){
                if(data.allFacturesQuery[i].pendiente == true){
                    if(data.allTypesQuery[i].refType__ingreso == true){
                        if(data.allFacturesQuery[i].nc == true){
                            if(data.allTypesQuery[i].refType__mercPagar == false){
                                $("#myTable").append("<tr><td style='color: #1029b9;' class='p-2'>"+data.dateDic[i]+"</td><td style='color: #1029b9;' class='p-2'>"+data.allTypesQuery[i].refPersona__nombre+"</td><td style='color: #1029b9;' class='p-2'>"+data.allFacturesQuery[i].num+"</td><td style='max-width: 100px;' class='p-2'><a style='color: #1029b9;' href='/contListByCategory/"+data.allCategorysQuery[i].refCategory__nombre+"'>"+data.allCategorysQuery[i].refCategory__nombre+"</a></td><td style='max-width: 100px;' class='p-2'><a style='color: #1029b9;' href='/contListByType/"+data.allTypesQuery[i].refType__nombre+"'>"+data.allTypesQuery[i].refType__nombre+"</a></td><td style='color: #1029b9;' id='auxMonto' class='p-2'><div style='font-weight: bold;'>$"+data.balance[data.allFacturesQuery[i].id][1].toFixed(2)+"</div></td><td style='color: #1029b9;' class='p-2'>$"+data.balance[data.allFacturesQuery[i].id][0].toFixed(2)+"</td><td style='color: #1029b9;' style='max-width: 100px;' class='p-2'>"+data.allFacturesQuery[i].note+"</td><td id='check' class='exclude'><a style='color: white;font-size: small;' class='btn btn-secondary mx-1' href='/editeFact/"+data.allFacturesQuery[i].id+"/accountStat'>Editar</a><a data-bs-toggle='modal' data-bs-target='#deleteFac"+data.allFacturesQuery[i].id+"' style='text-decoration: none;color: rgb(136,12,12);font-size: small;' id='deleteFacId' class='btn btn-danger text-white' href='javascript:void(0);'>Eliminar</a></td></tr>")
                                // $("#myTable").append("<tr><td style='color: #1029b9;' class='p-2'>"+data.dateDic[i]+"</td><td style='color: #1029b9;' class='p-2'>Nombre nc mercpagar</td><td style='color: #1029b9;' class='p-2'>"+data.allFacturesQuery[i].num+"</td><td style='max-width: 100px;' class='p-2'><a style='color: #1029b9;' href='/contListByCategory/"+data.allCategorysQuery[i].refCategory__nombre+"'>"+data.allCategorysQuery[i].refCategory__nombre+"</a></td><td style='max-width: 100px;' class='p-2'><a style='color: #1029b9;' href='/contListByType/"+data.allTypesQuery[i].refType__nombre+"'>"+data.allTypesQuery[i].refType__nombre+"</a></td><td style='color: #1029b9;' id='auxMonto' class='p-2'><div style='font-weight: bold;'>$"+data.balance[data.allFacturesQuery[i].id][1].toFixed(2)+"</div></td><td style='color: #1029b9;' class='p-2'>$"+data.balance[data.allFacturesQuery[i].id][0].toFixed(2)+"</td><td style='color: #1029b9;' style='max-width: 100px;' class='p-2'>"+data.allFacturesQuery[i].note+"</td><td id='check' class='exclude'><a style='color: white;font-size: small;' class='btn btn-secondary mx-1' href='/editeFact/"+data.allFacturesQuery[i].id+"/accountStat'>Editar</a><a data-bs-toggle='modal' data-bs-target='#deleteFac"+data.allFacturesQuery[i].id+"' style='text-decoration: none;color: rgb(136,12,12);font-size: small;' id='deleteFacId' class='btn btn-danger text-white' href='javascript:void(0);'>Eliminar</a></td></tr>")
                            }
                        }else{
                            if(data.allTypesQuery[i].refType__facCobrar == false | data.allTypesQuery[i].refType__mercPagar == true){
                                $("#myTable").append("<tr><td style='color: #1029b9;' class='p-2'>"+data.dateDic[i]+"</td><td style='color: #1029b9;' class='p-2'>"+data.allTypesQuery[i].refPersona__nombre+"</td><td style='color: #1029b9;' class='p-2'>"+data.allFacturesQuery[i].num+"</td><td style='max-width: 100px;' class='p-2'><a style='color: #1029b9;' href='/contListByCategory/"+data.allCategorysQuery[i].refCategory__nombre+"'>"+data.allCategorysQuery[i].refCategory__nombre+"</a></td><td style='max-width: 100px;' class='p-2'><a style='color: #1029b9;' href='/contListByType/"+data.allTypesQuery[i].refType__nombre+"'>"+data.allTypesQuery[i].refType__nombre+"</a></td><td style='color: #1029b9;' id='auxMonto' class='p-2'><div style='font-weight: bold;'>$"+data.balance[data.allFacturesQuery[i].id][1].toFixed(2)+"</div></td><td style='color: #1029b9;' class='p-2'>$"+data.balance[data.allFacturesQuery[i].id][0].toFixed(2)+"</td><td style='color: #1029b9;' style='max-width: 100px;' class='p-2'>"+data.allFacturesQuery[i].note+"</td><td id='check' class='exclude'><a style='color: white;font-size: small;' class='btn btn-secondary mx-1' href='/editeFact/"+data.allFacturesQuery[i].id+"/accountStat'>Editar</a><a data-bs-toggle='modal' data-bs-target='#deleteFac"+data.allFacturesQuery[i].id+"' style='text-decoration: none;color: rgb(136,12,12);font-size: small;' id='deleteFacId' class='btn btn-danger text-white' href='javascript:void(0);'>Eliminar</a></td></tr>")
                            }else{
                                $("#myTable").append("<tr><td style='color: #a00a0a;' class='p-2'>"+data.dateDic[i]+"</td><td style='color: #a00a0a;' class='p-2'>"+data.allTypesQuery[i].refPersona__nombre+"</td><td style='color: #a00a0a;' class='p-2'>"+data.allFacturesQuery[i].num+"</td><td style='max-width: 100px;' class='p-2'><a style='color: #a00a0a;' href='/contListByCategory/"+data.allCategorysQuery[i].refCategory__nombre+"'>"+data.allCategorysQuery[i].refCategory__nombre+"</a></td><td style='max-width: 100px;' class='p-2'><a style='color: #a00a0a;' href='/contListByType/"+data.allTypesQuery[i].refType__nombre+"'>"+data.allTypesQuery[i].refType__nombre+"</a></td><td style='color: #a00a0a;' id='auxMonto' class='p-2'><div style='font-weight: bold;'>$"+data.balance[data.allFacturesQuery[i].id][1].toFixed(2)+"</div></td><td style='color: #a00a0a;' class='p-2'>$"+data.balance[data.allFacturesQuery[i].id][0].toFixed(2)+"</td><td style='color: #a00a0a;' style='max-width: 100px;' class='p-2'>"+data.allFacturesQuery[i].note+"</td><td id='check' class='exclude'><a style='color: white;font-size: small;' class='btn btn-secondary mx-1' href='/editeFact/"+data.allFacturesQuery[i].id+"/accountStat'>Editar</a><a data-bs-toggle='modal' data-bs-target='#deleteFac"+data.allFacturesQuery[i].id+"' style='text-decoration: none;color: rgb(136,12,12);font-size: small;' id='deleteFacId' class='btn btn-danger text-white' href='javascript:void(0);'>Eliminar</a></td></tr>")
                            }
                        }
                    }else{
                        if(data.allFacturesQuery[i].nc == true){
                            if(data.allTypesQuery[i].refType__mercPagar == true){
                                $("#myTable").append("<tr><td style='color: #a00a0a;' class='p-2'>"+data.dateDic[i]+"</td><td style='color: #a00a0a;' class='p-2'>"+data.allTypesQuery[i].refPersona__nombre+"</td><td style='color: #a00a0a;' class='p-2'>"+data.allFacturesQuery[i].num+"</td><td style='max-width: 100px;' class='p-2'><a style='color: #a00a0a;' href='/contListByCategory/"+data.allCategorysQuery[i].refCategory__nombre+"'>"+data.allCategorysQuery[i].refCategory__nombre+"</a></td><td style='max-width: 100px;' class='p-2'><a style='color: #a00a0a;' href='/contListByType/"+data.allTypesQuery[i].refType__nombre+"'>"+data.allTypesQuery[i].refType__nombre+"</a></td><td style='color: #a00a0a;' id='auxMonto' class='p-2'><div style='font-weight: bold;'>$"+data.balance[data.allFacturesQuery[i].id][1].toFixed(2)+"</div></td><td style='color: #a00a0a;' class='p-2'>$"+data.balance[data.allFacturesQuery[i].id][0].toFixed(2)+"</td><td style='color: #a00a0a;' style='max-width: 100px;' class='p-2'>"+data.allFacturesQuery[i].note+"</td><td id='check' class='exclude'><a style='color: white;font-size: small;' class='btn btn-secondary mx-1' href='/editeFact/"+data.allFacturesQuery[i].id+"/accountStat'>Editar</a><a data-bs-toggle='modal' data-bs-target='#deleteFac"+data.allFacturesQuery[i].id+"' style='text-decoration: none;color: rgb(136,12,12);font-size: small;' id='deleteFacId' class='btn btn-danger text-white' href='javascript:void(0);'>Eliminar</a></td></tr>")
                            }else{
                                $("#myTable").append("<tr><td style='color: #1029b9;' class='p-2'>"+data.dateDic[i]+"</td><td style='color: #1029b9;' class='p-2'>"+data.allTypesQuery[i].refPersona__nombre+"</td><td style='color: #1029b9;' class='p-2'>"+data.allFacturesQuery[i].num+"</td><td style='max-width: 100px;' class='p-2'><a style='color: #1029b9;' href='/contListByCategory/"+data.allCategorysQuery[i].refCategory__nombre+"'>"+data.allCategorysQuery[i].refCategory__nombre+"</a></td><td style='max-width: 100px;' class='p-2'><a style='color: #1029b9;' href='/contListByType/"+data.allTypesQuery[i].refType__nombre+"'>"+data.allTypesQuery[i].refType__nombre+"</a></td><td style='color: #1029b9;' id='auxMonto' class='p-2'><div style='font-weight: bold;'>$"+data.balance[data.allFacturesQuery[i].id][1].toFixed(2)+"</div></td><td style='color: #1029b9;' class='p-2'>$"+data.balance[data.allFacturesQuery[i].id][0].toFixed(2)+"</td><td style='color: #1029b9;' style='max-width: 100px;' class='p-2'>"+data.allFacturesQuery[i].note+"</td><td id='check' class='exclude'><a style='color: white;font-size: small;' class='btn btn-secondary mx-1' href='/editeFact/"+data.allFacturesQuery[i].id+"/accountStat'>Editar</a><a data-bs-toggle='modal' data-bs-target='#deleteFac"+data.allFacturesQuery[i].id+"' style='text-decoration: none;color: rgb(136,12,12);font-size: small;' id='deleteFacId' class='btn btn-danger text-white' href='javascript:void(0);'>Eliminar</a></td></tr>")
                            }
                        }else{
                            if(data.allTypesQuery[i].refType__facCobrar == true | data.allTypesQuery[i].refType__mercPagar == false){
                                $("#myTable").append("<tr><td style='color: #a00a0a;' class='p-2'>"+data.dateDic[i]+"</td><td style='color: #a00a0a;' class='p-2'>"+data.allTypesQuery[i].refPersona__nombre+"</td><td style='color: #a00a0a;' class='p-2'>"+data.allFacturesQuery[i].num+"</td><td style='max-width: 100px;' class='p-2'><a style='color: #a00a0a;' href='/contListByCategory/"+data.allCategorysQuery[i].refCategory__nombre+"'>"+data.allCategorysQuery[i].refCategory__nombre+"</a></td><td style='max-width: 100px;' class='p-2'><a style='color: #a00a0a;' href='/contListByType/"+data.allTypesQuery[i].refType__nombre+"'>"+data.allTypesQuery[i].refType__nombre+"</a></td><td style='color: #a00a0a;' id='auxMonto' class='p-2'><div style='font-weight: bold;'>$"+data.balance[data.allFacturesQuery[i].id][1].toFixed(2)+"</div></td><td style='color: #a00a0a;' class='p-2'>$"+data.balance[data.allFacturesQuery[i].id][0].toFixed(2)+"</td><td style='color: #a00a0a;' style='max-width: 100px;' class='p-2'>"+data.allFacturesQuery[i].note+"</td><td id='check' class='exclude'><a style='color: white;font-size: small;' class='btn btn-secondary mx-1' href='/editeFact/"+data.allFacturesQuery[i].id+"/accountStat'>Editar</a><a data-bs-toggle='modal' data-bs-target='#deleteFac"+data.allFacturesQuery[i].id+"' style='text-decoration: none;color: rgb(136,12,12);font-size: small;' id='deleteFacId' class='btn btn-danger text-white' href='javascript:void(0);'>Eliminar</a></td></tr>")
                            }else{
                                $("#myTable").append("<tr><td style='color: #1029b9;' class='p-2'>"+data.dateDic[i]+"</td><td style='color: #1029b9;' class='p-2'>"+data.allTypesQuery[i].refPersona__nombre+"</td><td style='color: #1029b9;' class='p-2'>"+data.allFacturesQuery[i].num+"</td><td style='max-width: 100px;' class='p-2'><a style='color: #1029b9;' href='/contListByCategory/"+data.allCategorysQuery[i].refCategory__nombre+"'>"+data.allCategorysQuery[i].refCategory__nombre+"</a></td><td style='max-width: 100px;' class='p-2'><a style='color: #1029b9;' href='/contListByType/"+data.allTypesQuery[i].refType__nombre+"'>"+data.allTypesQuery[i].refType__nombre+"</a></td><td style='color: #1029b9;' id='auxMonto' class='p-2'><div style='font-weight: bold;'>$"+data.balance[data.allFacturesQuery[i].id][1].toFixed(2)+"</div></td><td style='color: #1029b9;' class='p-2'>$"+data.balance[data.allFacturesQuery[i].id][0].toFixed(2)+"</td><td style='color: #1029b9;' style='max-width: 100px;' class='p-2'>"+data.allFacturesQuery[i].note+"</td><td id='check' class='exclude'><a style='color: white;font-size: small;' class='btn btn-secondary mx-1' href='/editeFact/"+data.allFacturesQuery[i].id+"/accountStat'>Editar</a><a data-bs-toggle='modal' data-bs-target='#deleteFac"+data.allFacturesQuery[i].id+"' style='text-decoration: none;color: rgb(136,12,12);font-size: small;' id='deleteFacId' class='btn btn-danger text-white' href='javascript:void(0);'>Eliminar</a></td></tr>")
                            }
                        }
                    }
                }else{
                    if(data.allTypesQuery[i].refType__ingreso == true){
                        if(data.allFacturesQuery[i].nc == true){
                            if(data.allTypesQuery[i].refType__mercPagar == false){
                                $("#myTable").append("<tr><td style='color: #1029b9;' class='p-2'>"+data.dateDic[i]+"</td><td style='color: #1029b9;' class='p-2'>"+data.allTypesQuery[i].refPersona__nombre+"</td><td style='color: #1029b9;' class='p-2'>"+data.allFacturesQuery[i].num+"</td><td style='max-width: 100px;' class='p-2'><a style='color: #1029b9;' href='/contListByCategory/"+data.allCategorysQuery[i].refCategory__nombre+"'>"+data.allCategorysQuery[i].refCategory__nombre+"</a></td><td style='max-width: 100px;' class='p-2'><a style='color: #1029b9;' href='/contListByType/"+data.allTypesQuery[i].refType__nombre+"'>"+data.allTypesQuery[i].refType__nombre+"</a></td><td style='color: #1029b9;' id='auxMonto' class='p-2'><div>$"+data.balance[data.allFacturesQuery[i].id][1].toFixed(2)+"</div></td><td style='color: #1029b9;' class='p-2'>$"+data.balance[data.allFacturesQuery[i].id][0].toFixed(2)+"</td><td style='color: #1029b9;' style='max-width: 100px;' class='p-2'>"+data.allFacturesQuery[i].note+"</td><td id='check' class='exclude'><a style='color: white;font-size: small;' class='btn btn-secondary mx-1' href='/editeFact/"+data.allFacturesQuery[i].id+"/accountStat'>Editar</a><a data-bs-toggle='modal' data-bs-target='#deleteFac"+data.allFacturesQuery[i].id+"' style='text-decoration: none;color: rgb(136,12,12);font-size: small;' id='deleteFacId' class='btn btn-danger text-white' href='javascript:void(0);'>Eliminar</a></td></tr>")
                            }
                        }else{
                            if(data.allTypesQuery[i].refType__facCobrar == false | data.allTypesQuery[i].refType__mercPagar == true){
                                $("#myTable").append("<tr><td style='color: #1029b9;' class='p-2'>"+data.dateDic[i]+"</td><td style='color: #1029b9;' class='p-2'>"+data.allTypesQuery[i].refPersona__nombre+"</td><td style='color: #1029b9;' class='p-2'>"+data.allFacturesQuery[i].num+"</td><td style='max-width: 100px;' class='p-2'><a style='color: #1029b9;' href='/contListByCategory/"+data.allCategorysQuery[i].refCategory__nombre+"'>"+data.allCategorysQuery[i].refCategory__nombre+"</a></td><td style='max-width: 100px;' class='p-2'><a style='color: #1029b9;' href='/contListByType/"+data.allTypesQuery[i].refType__nombre+"'>"+data.allTypesQuery[i].refType__nombre+"</a></td><td style='color: #1029b9;' id='auxMonto' class='p-2'><div>$"+data.balance[data.allFacturesQuery[i].id][1].toFixed(2)+"</div></td><td style='color: #1029b9;' class='p-2'>$"+data.balance[data.allFacturesQuery[i].id][0].toFixed(2)+"</td><td style='color: #1029b9;' style='max-width: 100px;' class='p-2'>"+data.allFacturesQuery[i].note+"</td><td id='check' class='exclude'><a style='color: white;font-size: small;' class='btn btn-secondary mx-1' href='/editeFact/"+data.allFacturesQuery[i].id+"/accountStat'>Editar</a><a data-bs-toggle='modal' data-bs-target='#deleteFac"+data.allFacturesQuery[i].id+"' style='text-decoration: none;color: rgb(136,12,12);font-size: small;' id='deleteFacId' class='btn btn-danger text-white' href='javascript:void(0);'>Eliminar</a></td></tr>")
                            }else{
                                $("#myTable").append("<tr><td style='color: #a00a0a;' class='p-2'>"+data.dateDic[i]+"</td><td style='color: #a00a0a;' class='p-2'>"+data.allTypesQuery[i].refPersona__nombre+"</td><td style='color: #a00a0a;' class='p-2'>"+data.allFacturesQuery[i].num+"</td><td style='max-width: 100px;' class='p-2'><a style='color: #a00a0a;' href='/contListByCategory/"+data.allCategorysQuery[i].refCategory__nombre+"'>"+data.allCategorysQuery[i].refCategory__nombre+"</a></td><td style='max-width: 100px;' class='p-2'><a style='color: #a00a0a;' href='/contListByType/"+data.allTypesQuery[i].refType__nombre+"'>"+data.allTypesQuery[i].refType__nombre+"</a></td><td style='color: #a00a0a;' id='auxMonto' class='p-2'><div>$"+data.balance[data.allFacturesQuery[i].id][1].toFixed(2)+"</div></td><td style='color: #a00a0a;' class='p-2'>$"+data.balance[data.allFacturesQuery[i].id][0].toFixed(2)+"</td><td style='color: #a00a0a;' style='max-width: 100px;' class='p-2'>"+data.allFacturesQuery[i].note+"</td><td id='check' class='exclude'><a style='color: white;font-size: small;' class='btn btn-secondary mx-1' href='/editeFact/"+data.allFacturesQuery[i].id+"/accountStat'>Editar</a><a data-bs-toggle='modal' data-bs-target='#deleteFac"+data.allFacturesQuery[i].id+"' style='text-decoration: none;color: rgb(136,12,12);font-size: small;' id='deleteFacId' class='btn btn-danger text-white' href='javascript:void(0);'>Eliminar</a></td></tr>")
                            }
                        }
                    }else{
                        if(data.allFacturesQuery[i].nc == true){
                            if(data.allTypesQuery[i].refType__mercPagar == true){
                                $("#myTable").append("<tr><td style='color: #a00a0a;' class='p-2'>"+data.dateDic[i]+"</td><td style='color: #a00a0a;' class='p-2'>"+data.allTypesQuery[i].refPersona__nombre+"</td><td style='color: #a00a0a;' class='p-2'>"+data.allFacturesQuery[i].num+"</td><td style='max-width: 100px;' class='p-2'><a style='color: #a00a0a;' href='/contListByCategory/"+data.allCategorysQuery[i].refCategory__nombre+"'>"+data.allCategorysQuery[i].refCategory__nombre+"</a></td><td style='max-width: 100px;' class='p-2'><a style='color: #a00a0a;' href='/contListByType/"+data.allTypesQuery[i].refType__nombre+"'>"+data.allTypesQuery[i].refType__nombre+"</a></td><td style='color: #a00a0a;' id='auxMonto' class='p-2'><div>$"+data.balance[data.allFacturesQuery[i].id][1].toFixed(2)+"</div></td><td style='color: #a00a0a;' class='p-2'>$"+data.balance[data.allFacturesQuery[i].id][0].toFixed(2)+"</td><td style='color: #a00a0a;' style='max-width: 100px;' class='p-2'>"+data.allFacturesQuery[i].note+"</td><td id='check' class='exclude'><a style='color: white;font-size: small;' class='btn btn-secondary mx-1' href='/editeFact/"+data.allFacturesQuery[i].id+"/accountStat'>Editar</a><a data-bs-toggle='modal' data-bs-target='#deleteFac"+data.allFacturesQuery[i].id+"' style='text-decoration: none;color: rgb(136,12,12);font-size: small;' id='deleteFacId' class='btn btn-danger text-white' href='javascript:void(0);'>Eliminar</a></td></tr>")
                            }else{
                                $("#myTable").append("<tr><td style='color: #1029b9;' class='p-2'>"+data.dateDic[i]+"</td><td style='color: #1029b9;' class='p-2'>"+data.allTypesQuery[i].refPersona__nombre+"</td><td style='color: #1029b9;' class='p-2'>"+data.allFacturesQuery[i].num+"</td><td style='max-width: 100px;' class='p-2'><a style='color: #1029b9;' href='/contListByCategory/"+data.allCategorysQuery[i].refCategory__nombre+"'>"+data.allCategorysQuery[i].refCategory__nombre+"</a></td><td style='max-width: 100px;' class='p-2'><a style='color: #1029b9;' href='/contListByType/"+data.allTypesQuery[i].refType__nombre+"'>"+data.allTypesQuery[i].refType__nombre+"</a></td><td style='color: #1029b9;' id='auxMonto' class='p-2'><div>$"+data.balance[data.allFacturesQuery[i].id][1].toFixed(2)+"</div></td><td style='color: #1029b9;' class='p-2'>$"+data.balance[data.allFacturesQuery[i].id][0].toFixed(2)+"</td><td style='color: #1029b9;' style='max-width: 100px;' class='p-2'>"+data.allFacturesQuery[i].note+"</td><td id='check' class='exclude'><a style='color: white;font-size: small;' class='btn btn-secondary mx-1' href='/editeFact/"+data.allFacturesQuery[i].id+"/accountStat'>Editar</a><a data-bs-toggle='modal' data-bs-target='#deleteFac"+data.allFacturesQuery[i].id+"' style='text-decoration: none;color: rgb(136,12,12);font-size: small;' id='deleteFacId' class='btn btn-danger text-white' href='javascript:void(0);'>Eliminar</a></td></tr>")
                            }
                        }else{
                            if(data.allTypesQuery[i].refType__facCobrar == true | data.allTypesQuery[i].refType__mercPagar == false){
                                $("#myTable").append("<tr><td style='color: #a00a0a;' class='p-2'>"+data.dateDic[i]+"</td><td style='color: #a00a0a;' class='p-2'>"+data.allTypesQuery[i].refPersona__nombre+"</td><td style='color: #a00a0a;' class='p-2'>"+data.allFacturesQuery[i].num+"</td><td style='max-width: 100px;' class='p-2'><a style='color: #a00a0a;' href='/contListByCategory/"+data.allCategorysQuery[i].refCategory__nombre+"'>"+data.allCategorysQuery[i].refCategory__nombre+"</a></td><td style='max-width: 100px;' class='p-2'><a style='color: #a00a0a;' href='/contListByType/"+data.allTypesQuery[i].refType__nombre+"'>"+data.allTypesQuery[i].refType__nombre+"</a></td><td style='color: #a00a0a;' id='auxMonto' class='p-2'><div>$"+data.balance[data.allFacturesQuery[i].id][1].toFixed(2)+"</div></td><td style='color: #a00a0a;' class='p-2'>$"+data.balance[data.allFacturesQuery[i].id][0].toFixed(2)+"</td><td style='color: #a00a0a;' style='max-width: 100px;' class='p-2'>"+data.allFacturesQuery[i].note+"</td><td id='check' class='exclude'><a style='color: white;font-size: small;' class='btn btn-secondary mx-1' href='/editeFact/"+data.allFacturesQuery[i].id+"/accountStat'>Editar</a><a data-bs-toggle='modal' data-bs-target='#deleteFac"+data.allFacturesQuery[i].id+"' style='text-decoration: none;color: rgb(136,12,12);font-size: small;' id='deleteFacId' class='btn btn-danger text-white' href='javascript:void(0);'>Eliminar</a></td></tr>")
                            }else{
                                $("#myTable").append("<tr><td style='color: #1029b9;' class='p-2'>"+data.dateDic[i]+"</td><td style='color: #1029b9;' class='p-2'>"+data.allTypesQuery[i].refPersona__nombre+"</td><td style='color: #1029b9;' class='p-2'>"+data.allFacturesQuery[i].num+"</td><td style='max-width: 100px;' class='p-2'><a style='color: #1029b9;' href='/contListByCategory/"+data.allCategorysQuery[i].refCategory__nombre+"'>"+data.allCategorysQuery[i].refCategory__nombre+"</a></td><td style='max-width: 100px;' class='p-2'><a style='color: #1029b9;' href='/contListByType/"+data.allTypesQuery[i].refType__nombre+"'>"+data.allTypesQuery[i].refType__nombre+"</a></td><td style='color: #1029b9;' id='auxMonto' class='p-2'><div>$"+data.balance[data.allFacturesQuery[i].id][1].toFixed(2)+"</div></td><td style='color: #1029b9;' class='p-2'>$"+data.balance[data.allFacturesQuery[i].id][0].toFixed(2)+"</td><td style='color: #1029b9;' style='max-width: 100px;' class='p-2'>"+data.allFacturesQuery[i].note+"</td><td id='check' class='exclude'><a style='color: white;font-size: small;' class='btn btn-secondary mx-1' href='/editeFact/"+data.allFacturesQuery[i].id+"/accountStat'>Editar</a><a data-bs-toggle='modal' data-bs-target='#deleteFac"+data.allFacturesQuery[i].id+"' style='text-decoration: none;color: rgb(136,12,12);font-size: small;' id='deleteFacId' class='btn btn-danger text-white' href='javascript:void(0);'>Eliminar</a></td></tr>")
                            }
                        }
                    }
                }
            }

            if(data.acumTotal == 0){
                $(".tfoot thead").append("<tr style='background-color: #E77C7C;'><th colspan=9 id='balanceTotal' class='p-2'>TOTAL $"+data.acumTotal.toFixed(2)+"</th></tr>")
            }
            else{
                if(data.acumTotal < 0){
                    $(".tfoot thead").append("<tr style='background-color: #E77C7C;color: #c90a0a'><th colspan=9 id='balanceTotal' class='p-2'>TOTAL $"+data.acumTotal.toFixed(2)+"</th></tr>")
                }else{
                    $(".tfoot thead").append("<tr style='background-color: #E77C7C;color: #1029b9'><th colspan=9 id='balanceTotal' class='p-2'>TOTAL $"+data.acumTotal.toFixed(2)+"</th></tr>")
                }
            }
        }
    });
})

$("#invoice").dragtable()


</script>
{% endif %}

{% endblock %}